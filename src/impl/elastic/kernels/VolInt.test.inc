/**
 * @file This file is part of EDGE.
 *
 * @author Alexander Breuer (anbreuer AT ucsd.edu)
 *
 * @section LICENSE
 * Copyright (c) 2019, Alexander Breuer
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
 *
 * 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * @section DESCRIPTION
 * Fourth order reference solution for the volume integration unit tests.
 **/

// python code of the reference solution
/*
import numpy as np

# define raw stiffness matrices (generated by EDGEpre)
l_stiff0 = [0.0,0.0,0.0,20.0,0.0,0.0,0.0,14.0,21.0,0.0,0.0,0.0,0.0,0.0,10.8,16.2,21.6,0.0,0.0,50.4,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,25.2,-4.2,0.0,0.0,0.0,0.0,0.0,25.2,19.8,-7.2,0.0,0.0,-16.8,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,21.0,0.0,0.0,0.0,0.0,0.0,0.0,9.0,28.8,0.0,0.0,-16.8,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,21.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,9.0,12.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,28.8,-8.228571428571428,1.0285714285714285,0.0,0.0,2.4,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,25.714285714285715,-4.114285714285714,0.0,0.0,2.4,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,21.6,0.0,0.0,2.4,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,25.714285714285715,-1.7142857142857142,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,24.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,24.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,]

l_stiff1 = [0.0,0.0,10.0,10.0,0.0,7.0,-7.0,7.0,10.5,17.5,0.0,5.4,-5.4,18.0,5.4,8.1,10.8,13.5,18.0,25.2,
0.0,0.0,0.0,0.0,0.0,12.6,1.4,12.6,-2.1,-3.5,0.0,12.6,-6.6,-6.0,12.6,9.9,-3.6,16.5,-6.0,-8.4,
0.0,0.0,0.0,0.0,0.0,0.0,14.0,0.0,10.5,-3.5,0.0,0.0,6.0,-6.0,0.0,4.5,14.4,-1.5,12.0,-8.4,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,10.5,10.5,0.0,0.0,0.0,0.0,0.0,4.5,-10.8,4.5,6.0,16.8,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,14.4,2.742857142857143,0.8571428571428571,14.4,-4.114285714285714,0.5142857142857142,-6.857142857142857,0.8571428571428571,1.2,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,17.142857142857142,0.8571428571428571,0.0,12.857142857142858,-2.057142857142857,-4.285714285714286,-1.7142857142857142,1.2,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,18.0,0.0,0.0,10.8,0.0,-6.0,1.2,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,12.857142857142858,1.542857142857143,12.857142857142858,-0.8571428571428571,-2.4,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,14.4,0.0,12.0,-2.4,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,12.0,12.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,]

l_stiff2 = [0.0,6.666666666666667,3.3333333333333335,10.0,-5.833333333333333,2.3333333333333335,3.5,7.0,10.5,17.5,9.9,1.8,2.7,3.6,5.4,8.1,10.8,13.5,18.0,25.2,
0.0,0.0,0.0,0.0,10.5,4.2,-0.7,12.6,-2.1,-3.5,-6.3,4.2,3.3,-1.2,12.6,9.9,-3.6,16.5,-6.0,-8.4,
0.0,0.0,0.0,0.0,0.0,8.4,5.6,0.0,10.5,-3.5,0.0,-8.4,2.4,6.0,0.0,4.5,14.4,-1.5,12.0,-8.4,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,8.4,2.1,10.5,0.0,0.0,0.0,0.0,-8.4,0.9,1.2,4.5,6.0,16.8,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,14.4,4.8,-1.3714285714285714,0.17142857142857143,14.4,-4.114285714285714,0.5142857142857142,-6.857142857142857,0.8571428571428571,1.2,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,12.0,6.857142857142857,-0.8571428571428571,0.0,12.857142857142858,-2.057142857142857,-4.285714285714286,-1.7142857142857142,1.2,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,10.285714285714286,7.714285714285714,0.0,0.0,10.8,0.0,-6.0,1.2,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,12.0,2.5714285714285716,-0.17142857142857143,12.857142857142858,-0.8571428571428571,-2.4,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,10.285714285714286,4.114285714285714,0.0,12.0,-2.4,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,10.285714285714286,1.7142857142857142,12.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,]

l_stiff0 = np.array(l_stiff0).reshape(20,20)
l_stiff1 = np.array(l_stiff1).reshape(20,20)
l_stiff2 = np.array(l_stiff2).reshape(20,20)

# define dummy star matrices
l_starEnzIds = [ (0,6), (1,6), (2,6), (3,7), (5,8), (6,0), (7,3), (8,5),
                 (0,7), (1,7), (2,7), (3,6), (4,8), (6,3), (7,1), (8,4),
                 (0,8), (1,8), (2,8), (4,7), (5,6), (6,5), (7,4), (8,2) ]

l_starMatE0 = np.zeros( (9,9) )
l_starMatE1 = np.zeros( (9,9) )
l_starMatE2 = np.zeros( (9,9) )

np.random.seed(3343)

for l_id in l_starEnzIds:
  l_starMatE0[ l_id ] = np.random.rand()
  l_starMatE1[ l_id ] = np.random.rand()
  l_starMatE2[ l_id ] = np.random.rand()

# define dummy viscous star matrices
l_starVnzIds = [ (0, 6), (1, 7), (2, 8),
                 (3, 6), (3, 7),
                 (4, 7),         (4, 8),
                 (5, 6),         (5, 8) ]

l_starMatV0 = np.zeros( (6,9) )
l_starMatV1 = np.zeros( (6,9) )
l_starMatV2 = np.zeros( (6,9) )

for l_id in l_starVnzIds:
  l_starMatV0[ l_id ] = np.random.rand()
  l_starMatV1[ l_id ] = np.random.rand()
  l_starMatV2[ l_id ] = np.random.rand()

# define dummy source matrices
l_srcNzIds = [ (0,0), (0,1), (0,2),
               (1,0), (1,1), (1,2),
               (2,0), (2,1), (2,2),
               (3,3), (4,4), (5,5) ]

l_srcMat0 = np.zeros( (9,6) )
l_srcMat1 = np.zeros( (9,6) )

# omegas
l_oms = [ 0.012, 0.052 ]

for l_id in l_srcNzIds:
  l_srcMat0[ l_id ] = np.random.rand()
  l_srcMat1[ l_id ] = np.random.rand()

# init dofs and tDofs
l_dofsE        = np.random.rand( 9, 20 )
l_dofsV        = np.random.rand( 2, 6, 20 )
l_dofsEUpdated = np.zeros( (9, 20) )
l_dofsVUpdated = np.zeros( (2, 6, 20) )
l_tDofsE       = np.random.rand( 9, 20 )
l_tDofsV       = np.random.rand( 2, 6, 20 )

# perform elastic ck
l_dofsEUpdated += l_dofsE
l_dofsEUpdated +=   np.matmul( l_starMatE0, np.matmul( l_tDofsE, l_stiff0 ) ) \
                  + np.matmul( l_starMatE1, np.matmul( l_tDofsE, l_stiff1 ) ) \
                  + np.matmul( l_starMatE2, np.matmul( l_tDofsE, l_stiff2 ) )

def printCStyle( i_mat ):
  print( '{' )
  for l_ro in i_mat:
    print( '  {', end="" )
    for l_co in l_ro:
      print( l_co, end="," )
    print( '},' )
  print( '},' )

print( 'elastic solution')
print( 'starMatE 0' )
printCStyle( l_starMatE0 )
print( 'starMatE 1' )
printCStyle( l_starMatE1 )
print( 'starMatE 2' )
printCStyle( l_starMatE2 )
print( 'dofs' )
printCStyle( l_dofsE )
print( 'tDofs' )
printCStyle( l_tDofsE )
print( 'dofsUpdated' )
printCStyle( l_dofsEUpdated )

# perform viscoelastic ck
l_dofsEUpdated[:] = l_dofsE
l_dofsEUpdated +=   np.matmul( l_starMatE0, np.matmul( l_tDofsE, l_stiff0 ) ) \
                  + np.matmul( l_starMatE1, np.matmul( l_tDofsE, l_stiff1 ) ) \
                  + np.matmul( l_starMatE2, np.matmul( l_tDofsE, l_stiff2 ) ) \
                  + np.matmul( l_srcMat0, l_tDofsV[0] ) \
                  + np.matmul( l_srcMat1, l_tDofsV[1] )

l_dofsVUpdated[:] = l_dofsV
for l_vi in range(2):
    l_dofsVUpdated[l_vi] += l_oms[l_vi] * (   np.matmul( l_starMatV0, np.matmul( l_tDofsE, l_stiff0 ) ) \
                                            + np.matmul( l_starMatV1, np.matmul( l_tDofsE, l_stiff1 ) ) \
                                            + np.matmul( l_starMatV2, np.matmul( l_tDofsE, l_stiff2 ) ) \
                                            - l_tDofsV[l_vi] )

print( 'viscoelastic solution' )
print( 'starMatV 0' )
printCStyle( l_starMatV0 )
print( 'starMatV 1' )
printCStyle( l_starMatV1 )
print( 'starMatV 2' )
printCStyle( l_starMatV2 )
print( 'srcMat 0' )
printCStyle( l_srcMat0 )
print( 'srcMat 1' )
printCStyle( l_srcMat1 )
print( 'dofsV 0' )
printCStyle( l_dofsV[0] )
print( 'dofsV 1' )
printCStyle( l_dofsV[1] )
print( 'tDofsV 0' )
printCStyle( l_tDofsV[0] )
print( 'tDofsV 1' )
printCStyle( l_tDofsV[1] )
print( 'dofsEUpdated' )
printCStyle( l_dofsEUpdated )
print( 'dofsVUpdated 0' )
printCStyle( l_dofsVUpdated[0] )
print( 'dofsVUpdated 1' )
printCStyle( l_dofsVUpdated[1] )
*/
float l_rfs[2] = {0.012, 0.052};

float l_starE[3][9][9] = {
  {
    {0.0,0.0,0.0,0.0,0.0,0.0,0.31502566345387806,0.17661476441941415,0.5254352366074431,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.4324515724140714,0.145104758725479,0.041031159253460125,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.39985121899704656,0.5990846238512505,0.08073245532632756,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.5288961059771209,0.026977345180984713,0.0,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.12845718677742402,0.9129466698574331,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.35175193313938524,0.0,0.7065805011608832,},
    {0.32789142635669444,0.0,0.0,0.8246843537270405,0.0,0.10995184613860953,0.0,0.0,0.0,},
    {0.0,0.8825073057786866,0.0,0.04545564425537796,0.9716609168068608,0.0,0.0,0.0,0.0,},
    {0.0,0.0,0.675749791648789,0.0,0.7787644147790614,0.16271141716730497,0.0,0.0,0.0,},
  },
  {
    {0.0,0.0,0.0,0.0,0.0,0.0,0.6686942615102741,0.7092632178694926,0.38171894458920097,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.600432130975785,0.2839499700651775,0.9405131629213024,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.1543684265191141,0.9228883330076139,0.10697545851427537,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.8675113822389373,0.7876563493948178,0.0,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.21055395198417304,0.8834094321184481,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.855427863616338,0.0,0.0545912011591182,},
    {0.04383277467728808,0.0,0.0,0.7942610785991858,0.0,0.20956599868882875,0.0,0.0,0.0,},
    {0.0,0.5338618339303438,0.0,0.5915543218638859,0.39611007683105093,0.0,0.0,0.0,0.0,},
    {0.0,0.0,0.20563187445027964,0.0,0.4570543602158038,0.21032165415132298,0.0,0.0,0.0,},
  },
  {
    {0.0,0.0,0.0,0.0,0.0,0.0,0.5240257048836324,0.8300734026653475,0.13633714234056504,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.8142123084940156,0.18675814738620922,0.3193337700706066,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.5628388222969362,0.9162052839690623,0.852299854007144,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.9762351708589396,0.7019650033591671,0.0,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.8521368248412993,0.6444924751024506,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.7440056231049751,0.0,0.8062014187557345,},
    {0.7817780345840171,0.0,0.0,0.5273766966702069,0.0,0.40645785458234174,0.0,0.0,0.0,},
    {0.0,0.021139176990840447,0.0,0.38133187855089923,0.08272249318852198,0.0,0.0,0.0,0.0,},
    {0.0,0.0,0.6787477335595944,0.0,0.8613874091831872,0.27146748213875926,0.0,0.0,0.0,},
  },
};

float l_starA[3][6][3] = {
  {
    {0.23383889363393773,0.0,0.0,},
    {0.0,0.38216201131090644,0.0,},
    {0.0,0.0,0.4817278632059505,},
    {0.600785080814032,0.9662846252857071,0.0,},
    {0.0,0.04391413183260806,0.667924981950854,},
    {0.12066512003477525,0.0,0.13649699783111024,},
  },
  {
    {0.054742675839971056,0.0,0.0,},
    {0.0,0.08053171920572111,0.0,},
    {0.0,0.0,0.5319296537452306,},
    {0.5915212916928712,0.8548456926628406,0.0,},
    {0.0,0.6854049605932606,0.1867779476757424,},
    {0.07194010800992046,0.0,0.34686400793647265,},
  },
  {
    {0.9313589190382872,0.0,0.0,},
    {0.0,0.627140149419777,0.0,},
    {0.0,0.0,0.9748488015617851,},
    {0.3493547717613231,0.7735629263553444,0.0,},
    {0.0,0.8858152430736789,0.2183784080812342,},
    {0.9877663540141196,0.0,0.48207291480141023,},
  }
};

float l_srcA[2][6][6] = {
  {
    {0.18040568308983018,0.21149589716104722,0.959039808072128,0.0,0.0,0.0,},
    {0.6146223273627577,0.5717077682454518,0.588013308909576,0.0,0.0,0.0,},
    {0.5382228221440003,0.33178094323324814,0.2557777709740163,0.0,0.0,0.0,},
    {0.0,0.0,0.0,0.9208955092050831,0.0,0.0,},
    {0.0,0.0,0.0,0.0,0.7829178138909872,0.0,},
    {0.0,0.0,0.0,0.0,0.0,0.030568064537779716,}
  },
  {
    {0.8591711265668407,0.4882871365587155,0.23712759011787699,0.0,0.0,0.0,},
    {0.7449229369223274,0.9183068105773499,0.003488374932294258,0.0,0.0,0.0,},
    {0.9438779566985037,0.26353188237261727,0.6128992719943979,0.0,0.0,0.0,},
    {0.0,0.0,0.0,0.24962443209447138,0.0,0.0,},
    {0.0,0.0,0.0,0.0,0.46046315629073464,0.0,},
    {0.0,0.0,0.0,0.0,0.0,0.38293228138751845,}
  },
};

float l_dofsE[9][20] = {
  {0.9830231968674282,0.4037286258068854,0.4069948027631166,0.2277959888207005,0.8098198043973006,0.1351900414566426,0.431774226477032,0.00011263584762277734,0.8092104485716543,0.6899468018135323,0.29139289553906733,0.21429474020900952,0.7596166267147831,0.5484736726898856,0.303893702729475,0.0709296364975488,0.15811666250108958,0.5384484083804028,0.9796704261907097,0.07790227369938219,},
  {0.7018509328487825,0.64755685436897,0.4627554466815804,0.14159899383650387,0.6270481933191765,0.8948585225024033,0.5068923141542763,0.969433026272004,0.7900172144380949,0.906382464833375,0.6644718935395749,0.3386280685462211,0.4555936736348555,0.6955346001862238,0.49184935937873187,0.20291031311036145,0.6694835883812085,0.2465451468103259,0.631586345004049,0.011501585806741654,},
  {0.2254339684489649,0.4488480946430653,0.49887214953450654,0.758857498301866,0.8512384172747164,0.43713128112216526,0.28016403128520895,0.1375727172474821,0.3009910633719367,0.8383426781896217,0.015928517756633953,0.8047229312927168,0.36847243298558086,0.2071642372269613,0.8149361069563443,0.6676679744075215,0.9419038278203408,0.7816567304164916,0.9834524241793263,0.14136779901191754,},
  {0.7558668914987101,0.12263826700878122,0.49544525749360924,0.07665999408482171,0.49595693030545496,0.274403255653635,0.006253078678332802,0.6188911571113302,0.46489404080650176,0.6331766037263096,0.08535184011563535,0.8428811439758886,0.6653358742494558,0.0934694593163583,0.09552835506920088,0.018331698749472825,0.34309146081596764,0.2806300115303154,0.9795058821300665,0.5629753986334924,},
  {0.7512406248101109,0.9686878804243347,0.14560756659794327,0.25506879441240593,0.720779339052024,0.5685482829680449,0.5856170265288826,0.48119938998248835,0.9225578689888816,0.8569518963608754,0.48657002011878303,0.20080274974575352,0.572476437935921,0.6524285499354338,0.7732328922028542,0.4885637273705874,0.2108611303959117,0.06615849565711673,0.5743819875500165,0.3976665466913717,},
  {0.576261438247496,0.07185322745174405,0.7993315995414616,0.23379657726538283,0.6712607827596982,0.39745311601819144,0.5276788032882803,0.2588731105242157,0.10192504829305782,0.4571675606591682,0.09549208226775685,0.03973454106198293,0.8005990272394885,0.01927470528805242,0.13255847506360252,0.16935820806987623,0.6108038044003051,0.12032898633921518,0.5052000261675985,0.3362475688030221,},
  {0.5086366947462733,0.9538025451314955,0.09727388896073141,0.07313528972100236,0.860379502155309,0.5803009213865201,0.12118162942077759,0.22037585076031863,0.6803784633987648,0.9186181359189483,0.27515375420618904,0.1765628078786986,0.42255059300863784,0.9338891610943436,0.14470539491774703,0.5429045627015319,0.5706372442164516,0.5734094636554303,0.6600787664414439,0.20933842129341806,},
  {0.5002995902221733,0.7801339420875241,0.4456128919476785,0.9115627153041054,0.4678510355491027,0.5803315666446759,0.9157128090981275,0.7073440914043501,0.5242132010356504,0.2879616893912367,0.5571967910574841,0.7906479546119951,0.3430092473837858,0.4372457224854528,0.6955246348143972,0.974120324288659,0.9009975874561089,0.43343752159194326,0.03614922300599799,0.8908601976322653,},
  {0.9555312097043612,0.5917090823067621,0.6404651709150618,0.3280739619426897,0.8741367345796872,0.6769606765745706,0.08350988205426857,0.40464149214340794,0.1490034959183678,0.15126720667047366,0.4905129613408312,0.00039029606773943737,0.9840890392841251,0.030582857605681912,0.019313113008287863,0.5425988893678727,0.8609661341186937,0.21144911987650605,0.010661721517663647,0.9827667631143463,},
};

float l_dofsA[2][6][20] = {
  {
    {0.9445343052040858,0.11475512962501033,0.5427206463855078,0.15660504620648497,0.1361806330367762,0.894012978552536,0.18369474969582655,0.5736409713280851,0.620717094436384,0.2775798434829321,0.12896129085350738,0.9569240110402756,0.04155717639518519,0.0482133552395414,0.680345651922374,0.28329690946959774,0.7018870002444677,0.5997917812937408,0.2663867898184734,0.8024712740559365,},
    {0.4524335691208976,0.5368669939689092,0.013224465478016145,0.8644416930234293,0.31101980741438684,0.08483719166593284,0.4826683272076172,0.38278663363632925,0.8322677001692974,0.7714233275330086,0.8964991217883438,0.368277101055544,0.6101090288191946,0.33591870942558466,0.9638146297236853,0.785464381447578,0.6751567702334668,0.7011869496238655,0.8467802607982031,0.7034416705020814,},
    {0.5947632606865692,0.12140688892038554,0.3667942689742937,0.9112686422510718,0.5983681883738042,0.6352100183766681,0.6842408412420093,0.4069258631210021,0.6811702757845521,0.01502693265639743,0.17802988669379194,0.4797616091622243,0.6356313090305482,0.25784564110232877,0.43321954575916655,0.008610538576318438,0.30112453945880846,0.6562265448765717,0.31695495666209095,0.5804014939940874,},
    {0.15644295356607418,0.14868683426073204,0.6357891958073453,0.8707758558886078,0.3939352121662908,0.7089169646749649,0.5672655142625588,0.5425784005549168,0.9479758298066434,0.697240612499603,0.8032863322169681,0.10218219597790013,0.18576629467195627,0.19785565631887336,0.6309635750304853,0.017515729563623905,0.7084372751352906,0.5536942721886766,0.5201123919488356,0.3213928248954766,},
    {0.1166517156262098,0.07792400762412133,0.09841102418372794,0.884417857258409,0.6696196824886426,0.3605365951273276,0.894578167536445,0.04805053526224545,0.5364532036339619,0.7185295401951468,0.021723619379649062,0.3095269771719926,0.38447959978308033,0.5719665362775948,0.06956128054303101,0.768928617162076,0.04833335085377044,0.30897783293114744,0.6310753919962865,0.6733076657827068,},
    {0.1754975008953501,0.45597952452664137,0.1669559625204443,0.36979982071014383,0.19379862018052874,0.6239368427228148,0.8468388444017927,0.19234139078195622,0.8144673954714964,0.1687491071566778,0.9909871917334613,0.4780618020757581,0.474719345429111,0.15295893250412818,0.32173812550513003,0.8447354194944613,0.05021250849051728,0.3572441571635475,0.8109178140165463,0.706101626579549,},
  },
  {
    {0.5446212644595511,0.17233219243234166,0.6472579601456072,0.30355120970912586,0.41070060099176675,0.5559348959228195,0.5159591957004569,0.1096849540132333,0.6314490803181747,0.05208379452808731,0.05485738887289926,0.9411403862097424,0.5332405898032233,0.6931362926433794,0.060035523504603616,0.09105270485651695,0.6976147062133821,0.5330013257867603,0.8645862545017974,0.03540712407065327,},
    {0.6987495425657437,0.9500755955882899,0.27768238924012956,0.1674944813382926,0.6206782487304486,0.861267500307749,0.7115668641774274,0.8379016726998958,0.24088721049627182,0.4318101264702596,0.41524593336678695,0.9688132161645737,0.24754652676301026,0.9718934760112893,0.7164147301097085,0.4448939530485726,0.12894574018399496,0.32621149882005807,0.5482287300154562,0.685694344312362,},
    {0.4638484842010765,0.9435516371062797,0.7325926015892662,0.4348011553875396,0.24066985756768922,0.21082966281640292,0.5142598640448854,0.8700407075597396,0.37200592094184204,0.6186648885155009,0.4361547760251353,0.5218533517315908,0.006167867793398396,0.9484632251200636,0.7666229742182246,0.589697396935022,0.7109263843494841,0.4680067700571925,0.11579432151278268,0.6141011867302728,},
    {0.0920812054008866,0.48819108279960266,0.012937441142086059,0.954218821610174,0.5694453288118575,0.8330046097513446,0.2069028989815157,0.6302804994734054,0.6340596143477064,0.7862371934027583,0.7849911932583787,0.19031963139832397,0.9524884497508523,0.23439669066834345,0.6875201765053258,0.2478464799452773,0.645342234877958,0.2899723343809192,0.0693027983874821,0.0858703330475934,},
    {0.49108924135237175,0.15289367771238904,0.886653790969967,0.9306334720222659,0.9433430118590203,0.7480309399496365,0.9726623031603704,0.7658607639974325,0.7110047663970029,0.6353096503377826,0.4439741672318973,0.6516957650964602,0.5269153986822442,0.4726915865922885,0.657116064417069,0.567771077567296,0.014748376618127779,0.05618691456223979,0.987950709420194,0.6133262869432756,},
    {0.8613690303165805,0.8490062547338375,0.67012220218093,0.05245501090559779,0.1380048279322913,0.41583918240965734,0.15766481378059172,0.42957445409791617,0.5579063052099505,0.8345636002121606,0.8640805408422473,0.0033323734380261705,0.5175920519433239,0.7361469286539122,0.14466720482545414,0.02770417099269562,0.7305384285166829,0.23941902502639711,0.6431203571023046,0.45765719295536555,},
  },
};

float l_tDofsE[9][20] = {
  {0.9783010722329234,0.18483404368750544,0.5668800285150782,0.9419013191689349,0.1391467000415878,0.4279849610099733,0.41760738424279986,0.4070032435568387,0.4476168300514254,0.2501388133074496,0.9978056514233495,0.6888570211887163,0.38501729308456567,0.6108323044449526,0.24759502419392387,0.3544548390473524,0.49611367886908353,0.990615259543047,0.8260440997109975,0.24042385981795367,},
  {0.3065529490258122,0.90999796141851,0.19627655417083933,0.07944788609155662,0.2199935777891816,0.4050919567718443,0.755480665862891,0.637890703889115,0.7678529927369655,0.6771757114219993,0.9767527063585478,0.17230638470069493,0.34524485196721955,0.258009993349985,0.047801967444282445,0.9891567794309972,0.9740592760202594,0.2534247040787515,0.21173188170016144,0.23491695268270796,},
  {0.5737564485471592,0.9573283745622455,0.0834622709079923,0.28009782942341654,0.3431659839980632,0.35622272433336044,0.8981549524569347,0.06514284558461825,0.22490609595070588,0.22932242992187968,0.48582206694094054,0.7052131859912364,0.5912331037580215,0.9874699333101549,0.4456737366772108,0.6132094577766083,0.7434385786738397,0.8019474851494924,0.9534881947127489,0.8096327973022361,},
  {0.5164936187580832,0.9242562607088821,0.20776129724006764,0.9804034412428252,0.6562266299725019,0.9051040151853114,0.2654704431142284,0.606302256966974,0.19813424624224274,0.8416319916416717,0.24723034223167795,0.13375598559108337,0.2461031439623671,0.3600687816330802,0.14247596680824626,0.623860487690685,0.404360495519122,0.9878088510593029,0.6942164729592576,0.8041449065121399,},
  {0.37658234231019694,0.8625002465750149,0.9097577398443197,0.03281828542791487,0.8380262862901032,0.7598903095095307,0.19724556634932577,0.2255600296440441,0.6739643473309067,0.3045774805964301,0.982173442435529,0.072894027136432,0.14985527098524865,0.6439021875226807,0.1331223184817315,0.5506800122978934,0.0787545458188923,0.7003740961086747,0.10221774453447496,0.36153024171623205,},
  {0.428789171348793,0.019115257490345594,0.15763600756884733,0.7440820251310885,0.909836825555132,0.39394375133619575,0.899523095253169,0.6190905055409714,0.8779981493330244,0.6575989061126822,0.9376875628663052,0.4750735264150283,0.8088062440158791,0.9947176374739017,0.9222901616497177,0.7155926405605043,0.002367269660077387,0.28316396783936504,0.9869204635421029,0.3516838643488728,},
  {0.6626337950523442,0.5030718419265641,0.24810945660853256,0.20486464163829698,0.7353297010971358,0.7816827656396115,0.45246550433665744,0.027005661211387477,0.5676881112297157,0.2604435646938088,0.0046316847604325195,0.5769625020706861,0.029200989138925326,0.015303546675210167,0.7307360101200022,0.21042110349310994,0.2685320889731563,0.6730964900438644,0.9754420413574172,0.42908123096228956,},
  {0.7232095028257435,0.41014553419080846,0.7221980984086308,0.26716096068188855,0.6263497884655712,0.2974802862388881,0.9921539989171864,0.9119899827381099,0.41491652137590584,0.3281966381672614,0.13528410050580408,0.6847823188643063,0.7307617670230115,0.3174606417563316,0.779077270455283,0.06431244719874107,0.8235965901557188,0.6697423840963701,0.4517589794298199,0.3754550664087489,},
  {0.0008160918517908788,0.5578751332882056,0.5543526667303511,0.06880053285149501,0.24432143702449338,0.8086860475813998,0.08205599363503979,0.279076336795995,0.6021212789022629,0.5125328609383577,0.8081583606210657,0.7949654451934328,0.3099713527809633,0.06687833520013231,0.5295585686292826,0.861166792881355,0.044723117486983766,0.027920203044636716,0.7501482925418662,0.04528035645023032,},
};

float l_tDofsA[2][6][20] = {
  {
    {0.31878423041415915,0.20544512385571279,0.5115757825171984,0.8046112663931546,0.5823860652093198,0.6459319055743562,0.6310341561711799,0.5512234597760803,0.5417326437370152,0.4431765914465434,0.5487340310690585,0.8232236993388766,0.8658338388993251,0.7192434430299569,0.6580437297576857,0.45462300668317546,0.09238360961568248,0.6782608942842698,0.36516121945424473,0.7981372353751272,},
    {0.12493342564996102,0.4934233955686983,0.8410572138397833,0.4520307591846754,0.1805870706889634,0.051110999241976485,0.08895785597214556,0.23068007406892355,0.575176545903077,0.36405050404469597,0.18040036059318043,0.2994273481349812,0.12964529118160428,0.9261798901319492,0.9511247289726361,0.8883689326374066,0.96062577670812,0.6586048315572283,0.0547514303623553,0.3081946756808286,},
    {0.14814593533808318,0.8969140460573386,0.2699593583218681,0.427139470161471,0.7184294106224952,0.4418830629881727,0.41366782896032817,0.33434726589046315,0.07403717262813148,0.746722639033392,0.956924525313502,0.7714249538612207,0.4889183962010262,0.6306082188850504,0.3015528343873617,0.7946896327167435,0.4544370441448352,0.9549537677835575,0.7327703993701707,0.6088384111059496,},
    {0.07695487507792176,0.017696404215638895,0.805993373541131,0.7734791520498273,0.5649355578856415,0.521072029349515,0.5775341310090589,0.9740421732149224,0.4990910802293026,0.2805719142650389,0.16100004140716306,0.6869764287400071,0.804364102023363,0.7347911476778706,0.30165760619053694,0.9849414134517672,0.5586063483968826,0.9889688613600414,0.6867065108820506,0.9660589214618642,},
    {0.6471783225930412,0.41945749895004547,0.5528069907604088,0.2201849778695112,0.5034996032180346,0.7269139500852195,0.1396354514613798,0.11681136103894463,0.7867498108864719,0.7258279527230973,0.3397872859105858,0.04684783948730775,0.12977712040224787,0.4939558079958598,0.5466698759756436,0.823719620041957,0.022970401727640755,0.7190302802676313,0.8786431833962371,0.836909817367537,},
    {0.056373191297334424,0.5393248243575922,0.13393379071717593,0.7424726201732371,0.12666594089923344,0.7821079266991319,0.9500011622438143,0.5124132102454964,0.7870833887404922,0.009436542796784075,0.8501103780788895,0.8293011747882232,0.14440293035828256,0.8243082036508947,0.570624803065271,0.17354607345980133,0.5196458387814902,0.5234332591177392,0.5631185136520922,0.5167932360137195,},
  },
  {
    {0.003262548563832901,0.9322746665428855,0.5343400406480482,0.9729942210821515,0.8442939387694768,0.9923756075146049,0.6758603256637084,0.02615368916705474,0.435488002405374,0.466707775729299,0.657238650762792,0.10979331856993835,0.948608448488753,0.9371419867610591,0.7474817697985153,0.6516260495228741,0.008446162141363844,0.9605401542355072,0.31715638186456685,0.7316888569459239,},
    {0.5107181595953325,0.7679418801289193,0.13591222554402227,0.5122865315168502,0.18708206679950878,0.49462894596862006,0.018937753370059318,0.23402918627165137,0.2145433992933311,0.6377911444811094,0.6531411380714763,0.3743208197583977,0.665889269751023,0.8510160845350568,0.09593706098555244,0.3447539420984722,0.07176249500140253,0.4346766824125461,0.45070312025093806,0.10414630310115458,},
    {0.2732012492241048,0.08978552345281643,0.10631410637628924,0.9072295462734342,0.7440025152437769,0.844985584463114,0.6150216907880769,0.5360235229024387,0.9460445029045115,0.761942630052978,0.9290930089365955,0.031636636269654295,0.17327965217951768,0.33041548250958175,0.725541021844499,0.981663607092802,0.2456659181952615,0.14355011453291566,0.028329743322251133,0.8045527963873844,},
    {0.5095959351876842,0.10683034831798122,0.14615222733905742,0.623360211523303,0.6853115339045365,0.6408826558037055,0.6538927504183456,0.5106279788581453,0.8323048498014503,0.022784670028411114,0.2571239010183852,0.6762071605099571,0.6136983032675869,0.8464132996677898,0.4838473993671273,0.2664555022394991,0.01485707848522233,0.9916591746057829,0.0012505082266917045,0.2632904176277614,},
    {0.6778964766718736,0.07642486310216101,0.2574330265735728,0.33710616078665345,0.22634883166276032,0.5385418976515084,0.3558197194525986,0.5879580498025673,0.5552810027941979,0.2918397326684462,0.9733280340178524,0.6675371035002386,0.18132725697335017,0.6002845801174891,0.5356303966111899,0.36690396124670666,0.1720700676613831,0.7520440435925769,0.9052630487492811,0.17543622834798656,},
    {0.34272847851858157,0.15613165684531938,0.3961856350180091,0.04850908197171688,0.5330527300284277,0.2027314960410922,0.5588688090877472,0.8442549214547265,0.3697503755686392,0.6648557569945523,0.3142317152612226,0.2403714133013909,0.22609764240672026,0.281233322013719,0.2932676249127827,0.552318546813836,0.7848860132790452,0.060143965278818046,0.12728320093822187,0.7032525823249488,},
  },
};

float l_refEdofs[9][20] = {
  {0.9830231968674282,6.721497812563291,13.129447727367458,26.006116706101754,2.42316382639447,29.24726808550626,14.71919886003974,53.25113460481354,55.12960479369461,33.120457520212895,18.903680845330676,42.29308856377851,37.81161791457656,43.033110873566876,95.34483838970183,109.718593667257,96.48509451818859,65.35977614338881,77.64931722012908,58.38704349621763,},
  {0.7018509328487825,5.146559951457725,8.752151829494302,20.760631518044566,3.6661340752673985,25.689045059885867,14.630143864421184,45.2218283825536,40.59255311087583,20.80435825904367,14.589494611565744,42.61344571653935,37.7230316307912,22.371133395840392,76.53446218702328,93.25647405306057,73.14714900284396,43.43611800377392,63.089385483911876,47.40725950522417,},
  {0.2254339684489649,7.35724774593062,11.651258480965986,32.78533365632683,6.717617737241135,30.208014651316205,16.27729939944542,59.26259334827401,65.78185381639048,32.128839494713716,20.350164470846277,40.28797135211032,37.877092068967315,43.84112893776462,108.2443601374719,120.2136421723419,119.7583194274709,82.79413238763911,77.45344221693476,70.52918773468045,},
  {0.7558668914987101,7.819666115077364,15.788788344602482,30.466525055020774,1.9408120501021846,30.114057312943235,11.726260473403338,51.51602311348905,52.13286269253251,40.6866591549316,23.276022510018915,49.15887314371721,37.191783868035266,50.1785886263042,92.2641513698529,97.95997150905009,91.33137683781399,59.25488202711252,75.25138349067807,75.36493860265193,},
  {0.7512406248101109,5.080683977027371,3.7315612366176247,9.825948691476817,4.567770360656169,21.525080679419165,16.41997916909467,39.85969494760487,37.23444003769486,10.293436335279212,12.079157946077883,21.86353060106255,33.9925875781876,15.699867834788652,69.23635076941075,94.42210066739645,65.47475513416981,51.92434109885212,57.00415961412852,13.977607340594105,},
  {0.576261438247496,3.362927920698961,8.113668577125658,15.512395307352413,6.4440744593970685,20.089253388755605,5.287132929456649,43.281923958014985,32.59908875971847,18.057137358214757,10.50572437304363,35.57574626917481,27.283882659450768,20.96734716467438,72.54504367925155,93.80556771534746,51.22796312515303,34.507221147555484,54.800402478694316,35.18166964023609,},
  {0.5086366947462733,9.030373976119101,9.565280205562456,33.49505106059896,0.5102290338092023,24.478119700776762,7.732241278318673,74.93535824756282,59.59512574031031,75.59810519664973,20.114011987761778,38.15891184194115,30.888472437407273,26.75102659216045,96.04427802928245,124.2920906540888,66.6044790604271,96.68442397592773,87.01870754740955,133.18394656432102,},
  {0.5002995902221733,2.3440512033792937,7.411161647602032,22.639490958252665,3.7512715583549205,25.964464105282836,8.143075890601457,84.40682288624951,50.15840222700508,19.961799292534316,4.757190111409904,41.011617847166285,18.06706312928906,14.900479186949239,124.3556891572427,133.18747388526253,75.08740530185905,70.4816407662531,68.71609351532483,49.99911655179538,},
  {0.9555312097043612,6.126519042091595,7.210718784068447,27.44820996936845,10.709343145289042,26.06351406673384,11.652967530925503,81.33888881828199,52.94501217270481,23.51077722344761,17.20843201830805,36.59492701166966,32.934093406562276,23.69846971713022,130.76145526142082,123.54914052814897,96.63519298035509,57.01331416632522,65.6417880148326,47.133280482948614,},
};

float l_refVdofsE[9][20] = {
  {1.525998189158218,8.920344820802914,14.209184561029895,27.957760178312714,4.2485916756249145,31.09290190241883,15.984344495061935,53.98386857859463,56.12323926962879,34.886625697093365,21.06247270652959,43.52936690267239,39.6453824522408,45.26258428092553,96.81501874963843,111.71161234631155,97.2413042414605,67.6088242529646,78.92881197111339,60.050395077105286,},
  {1.528699369958938,7.482314742776245,10.229378504032647,22.963163437387717,5.353098656502144,27.57151501673857,15.83509158522306,46.12536779035712,41.82260365585311,22.659965058377185,16.685196569002784,44.16984974311395,39.93553749132209,25.194251778646308,78.30743996265358,95.31649649815449,74.09339098357829,45.906243023638005,64.42624192082438,49.075511502779946,},
  {0.7814686959101284,8.998302313860219,12.880025429803858,35.08705373576151,8.576955957690958,32.270574472336286,17.772124651966053,60.1362167150253,67.33061290750753,33.75473488809185,22.31203609063556,41.24937381276188,39.68822852525794,46.00815551858984,110.16672746622594,122.26390850489484,120.420446929119,84.73112196178793,78.29106701799977,72.42792453955362,},
  {0.9539418862882831,7.862630119277955,16.56750718949442,31.33442447139901,2.632129170808051,30.75389017373778,12.421336667536112,52.540479395813044,52.800237052461156,40.950724181103645,23.488471132902234,49.96030448029414,38.085713247784874,51.06653993365118,92.66272663699873,98.93351343695291,91.84950360524559,60.41316136857489,75.88408059009716,76.32030164602992,},
  {1.5700744136189901,5.44427555880863,4.282902101276964,10.153560399802926,5.066194466752767,22.34217326209416,16.693144122584123,40.22188166240574,38.106086922888146,10.996081413721706,12.793365163801067,22.207584850758362,34.17768691865349,16.363003568577085,69.9109864166585,95.23595118763004,65.57197099733314,52.83357128798296,58.10890529516379,14.713620864664257,},
  {0.709226455772867,3.439201888289342,8.2694749429545,15.553666951750847,6.652069490062845,20.190793348622574,5.530181534355381,43.62087990124108,32.764737730402494,18.31202054688353,10.652040069554277,35.693142374682836,27.37487686356855,21.100237988643507,72.67478821572345,94.02237328410531,51.54440588438379,34.54625255503733,54.86635676827964,35.4667651249686,},
  {0.5086366947462733,9.030373976119101,9.565280205562456,33.49505106059896,0.5102290338092023,24.478119700776762,7.732241278318673,74.93535824756282,59.59512574031031,75.59810519664973,20.114011987761778,38.15891184194115,30.888472437407273,26.75102659216045,96.04427802928245,124.2920906540888,66.6044790604271,96.68442397592773,87.01870754740955,133.18394656432102,},
  {0.5002995902221733,2.3440512033792937,7.411161647602032,22.639490958252665,3.7512715583549205,25.964464105282836,8.143075890601457,84.40682288624951,50.15840222700508,19.961799292534316,4.757190111409904,41.011617847166285,18.06706312928906,14.900479186949239,124.3556891572427,133.18747388526253,75.08740530185905,70.4816407662531,68.71609351532483,49.99911655179538,},
  {0.9555312097043612,6.126519042091595,7.210718784068447,27.44820996936845,10.709343145289042,26.06351406673384,11.652967530925503,81.33888881828199,52.94501217270481,23.51077722344761,17.20843201830805,36.59492701166966,32.934093406562276,23.69846971713022,130.76145526142082,123.54914052814897,96.63519298035509,57.01331416632522,65.6417880148326,47.133280482948614,},
};

float l_refVdofsA[2][6][20] = {
  {
    {0.9407088944391159,0.1616617797449969,0.5656206544436082,0.2625485129090085,0.14502760390760203,0.9576602073317816,0.21333282537903112,0.7777592915632355,0.768833927756388,0.415896017027082,0.2786153275258204,1.1184514881874863,0.18359527475892806,0.12014371877070505,1.0145668540881434,0.6693198947076415,0.9528959601111588,0.7440986687205722,0.5090596564603604,1.0937135785988674,},
    {0.45093436801309805,0.5672302104752001,0.028262884091512952,0.9867646939136738,0.3095135626507745,0.16542782966545927,0.5343591222413815,0.5776147663404989,1.0851664868642013,0.8904266502861532,0.9966481752408681,0.408765327305962,0.7365508658701667,0.4538312967714997,1.3374593451774501,1.0935178735954607,1.1617967923730177,1.0309253535775627,1.0695399240036407,0.9749036979138563,},
    {0.5929855094625122,0.11070756566079208,0.36363867173571623,0.9063848811676601,0.6582156778583746,0.756717875652059,0.765545719776725,0.6182097346895753,0.8246515544810225,-0.04264837369897115,0.16668359872585892,0.6380531547737397,0.8281822344222483,0.25386301956836493,0.7748033357086155,0.6217924934756573,0.5364463614840804,0.880619695226018,0.6068696969283036,0.5021110420424651,},
    {0.15551949506513912,0.21174986441860255,0.7789783120393368,1.3408929429593532,0.39391103678944084,0.9975720507920512,0.6871874574357869,1.2783098139081446,1.823461147889068,1.1401571364993743,0.9861616514012597,0.5171384414350157,0.5008879677525877,0.7194789671919491,2.0025613476516493,1.3278477491419667,2.3025044978761686,1.458228321839692,1.3909292333257484,1.4050823758346653,},
    {0.1088855757550933,0.12415517510697859,0.17691092607926906,1.0259268901193137,0.6798488842106809,0.5708057154510844,1.0322435331173174,0.42266337622545413,0.9403565065571634,0.9258053697875426,0.16219184397161832,0.5414364220810743,0.6507971465383877,0.9162509320900227,0.7433873060294418,1.6160984054400878,0.7823348610116287,0.8908597182542172,1.203787914878393,0.9430233992533259,},
    {0.17482102259978208,0.5019012893194008,0.19729995073568096,0.46445136897859357,0.24293176930933016,0.7618878438016047,0.9260731193476419,0.47433755759283397,1.0102164851725015,0.28721951730839457,1.1465549167156153,0.7467813566519577,0.7486888782517048,0.22878573423821993,0.7740366966148726,1.4914883922454476,0.3958481334194046,0.6246862216237109,1.1898785918564694,0.9399286032789882,},
  },
  {
    {0.5444516119342317,0.33779920673255054,0.7453075869745716,0.7538836517762333,0.43541826534021727,0.8137244814653238,0.6420598961807319,1.0215013031038875,1.2788134127207706,0.6502302583033668,0.6977159742288482,1.6781911669809737,1.1444347363474587,0.9935038103377378,1.5036766214741477,1.753574815993709,1.7896849462377085,1.1436526497855655,1.9186649281713044,1.300912426101672,},
    {0.6721921982667864,1.0673745725850852,0.3795164092899953,0.6944275183680789,0.6138134482903803,1.1874306650759114,0.9392013546590475,1.6819827605834223,1.3555348764645623,0.9332566784311929,0.8246426445655208,1.140367736058634,0.7675764670982796,1.4867565390679596,2.380011589144685,1.8080603985307553,2.2839400601041313,1.7667221797082688,1.492931116031479,1.872640311804196,},
    {0.44964201924142305,0.9391585861568098,0.7274278999899342,0.3886735067349334,0.4986791772271878,0.716402379893066,0.8561106035469437,1.7751169856589342,0.9484137474521751,0.367947121442552,0.3884347670156913,1.2462523752295853,0.8569684258465502,0.9468152207644115,2.224772011584732,3.2370965548312682,1.7415103783417072,1.4825700782071598,1.4087224434475294,0.2646654135719422,},
    {0.06558221677112702,0.7568292483903863,0.6677353510832237,2.9991990504907835,0.5630810180925252,2.077613163683101,0.722594004522888,3.842547495443945,4.410502210020462,2.7189470674354053,1.5724524690238586,1.9890233636604542,2.3279303213022224,2.488960019214862,6.6216366552851875,5.963313165501134,7.581241828790503,4.209479986579874,3.8784861564921824,4.818402349316786,},
    {0.45583862456543434,0.3710664338688605,1.2421794786550273,1.5377593795744944,1.002081392775394,1.668992474745802,1.5579706387419407,2.364683447022295,2.4732887904183407,1.5560722993476728,1.0197256882288528,1.6243608513071417,1.678277494186879,1.9590615389624848,3.5776028944518004,4.2625945743627,3.1876684046736257,2.5759583686026444,3.4683207422442965,1.8164910919449744,},
    {0.8435471494336143,1.0679266135464334,0.7879757218766454,0.49869782405535906,0.32978302778904606,1.0437544281452982,0.521352220910054,1.6343020746288395,1.427853677265909,1.3138535783979828,1.5660730395647668,1.1984081241988729,1.7005452358147117,1.0929696300134428,2.1190502528982678,2.81060421763256,2.2145003141346553,1.4224256809667288,2.3079471640030924,1.4612115393114182,},
  },
};

// extract elastic sparse star-matrices (compressed rows)
float l_starSpE[3][24];
unsigned short l_nz = 0;
for( unsigned short l_ro = 0; l_ro < 9; l_ro++ ) {
  for( unsigned short l_co = 0; l_co < 9; l_co++ ) {
    if( l_starE[0][l_ro][l_co] != 0.0f ) {
      EDGE_CHECK_NE( l_starE[1][l_ro][l_co], 0.0f );
      EDGE_CHECK_NE( l_starE[2][l_ro][l_co], 0.0f );

      for( unsigned short l_di = 0; l_di < 3; l_di++ )
        l_starSpE[l_di][l_nz] = l_starE[l_di][l_ro][l_co];

      l_nz++;
    }
  }
}
EDGE_CHECK_EQ( l_nz, 24 );

// extract anelastic sparse star matrices (compressed rows)
float l_starSpA[3][9];

l_nz = 0;

for( unsigned short l_ro = 0; l_ro < 6; l_ro++ ) {
  for( unsigned short l_co = 0; l_co < 3; l_co++ ) {
    if( l_starA[0][l_ro][l_co] != 0.0f ) {
      EDGE_CHECK_NE( l_starA[1][l_ro][l_co], 0.0f );
      EDGE_CHECK_NE( l_starA[2][l_ro][l_co], 0.0f );

      for( unsigned short l_di = 0; l_di < 3; l_di++ )
        l_starSpA[l_di][l_nz] = l_starA[l_di][l_ro][l_co];

      l_nz++;
    }
  }
}
EDGE_CHECK_EQ( l_nz, 9 );

// extract anelastic sparse source matrices (compress rows)
float l_srcSpA[2][12];

l_nz = 0;
for( unsigned short l_ro = 0; l_ro < 6; l_ro++ ) {
  for( unsigned short l_co = 0; l_co < 6; l_co++ ) {
    if( l_srcA[0][l_ro][l_co] != 0.0f ) {
      EDGE_CHECK_NE( l_srcA[1][l_ro][l_co], 0.0f );
      for( unsigned short l_rm = 0; l_rm < 2; l_rm++ )
        l_srcSpA[l_rm][l_nz] = l_srcA[l_rm][l_ro][l_co];

      l_nz++;
    }
  }
}
EDGE_CHECK_EQ( l_nz, 12 );