/**
 * @file This file is part of EDGE.
 *
 * @author Alexander Breuer (anbreuer AT ucsd.edu)
 *
 * @section LICENSE
 * Copyright (c) 2019, Alexander Breuer
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
 *
 * 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * @section DESCRIPTION
 * Fourth order reference solution for the ADER time predicition unit tests.
 **/

// python code of the reference solution
/*
import numpy as np

# define raw stiffness matrices (generated by EDGEpre)
l_stiffT0 = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
1.0,3.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
1.0,-0.3333333333333333,3.3333333333333335,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,6.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.6,2.3333333333333335,0.0,0.0,3.7333333333333334,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.6,1.2222222222222223,1.1111111111111112,0.0,-0.7111111111111111,4.444444444444445,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.6,-0.3333333333333333,2.6666666666666665,0.0,0.06666666666666667,-0.5333333333333333,4.2,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,2.0,0.0,0.0,0.0,8.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,2.0,0.0,0.0,0.0,-0.4,8.4,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.6,-0.3333333333333333,-0.6666666666666666,0.0,0.06666666666666667,0.13333333333333333,0.2,0.0,0.0,10.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]

l_stiffT1 = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
3.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
1.5,4.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
-1.0,0.3333333333333333,6.666666666666667,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.5,1.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.5,-0.16666666666666666,1.6666666666666667,5.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.5,-0.16666666666666666,-0.3333333333333333,3.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.9,3.5,0.0,0.0,5.6,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
-0.6,-1.2222222222222223,2.2222222222222223,0.0,0.7111111111111111,8.88888888888889,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
1.5,-0.8333333333333334,-1.6666666666666667,0.0,0.16666666666666666,0.3333333333333333,10.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.3,1.1666666666666667,0.0,0.0,1.8666666666666667,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.3,0.6111111111111112,0.5555555555555556,1.6666666666666667,-0.35555555555555557,2.2222222222222223,0.0,6.666666666666667,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.3,-0.16666666666666666,1.3333333333333333,-3.0,0.03333333333333333,-0.26666666666666666,2.1,0.6,8.4,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.3,0.6111111111111112,-0.1111111111111111,1.0,-0.35555555555555557,-0.4444444444444444,0.0,4.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.3,-0.16666666666666666,0.6666666666666666,1.0,0.03333333333333333,-0.13333333333333333,-0.7,-0.2,4.2,7.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.3,-0.16666666666666666,-0.3333333333333333,2.0,0.03333333333333333,0.06666666666666667,0.1,-0.4,-0.6,5.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]

l_stiffT2 = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
4.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
-2.5,7.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.5,1.5,6.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.5,-0.16666666666666666,2.6666666666666665,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.5,1.5,0.0,6.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.5,-0.16666666666666666,1.6666666666666667,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.5,-0.16666666666666666,-0.3333333333333333,3.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
3.3,-3.5,0.0,0.0,11.2,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.3,1.1666666666666667,-4.666666666666667,0.0,1.8666666666666667,9.333333333333334,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.3,0.6111111111111112,0.8888888888888888,0.0,-0.35555555555555557,3.5555555555555554,8.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.3,-0.16666666666666666,1.6666666666666667,0.0,0.03333333333333333,-0.3333333333333333,4.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.3,1.1666666666666667,0.0,-4.666666666666667,1.8666666666666667,0.0,0.0,9.333333333333334,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.3,0.6111111111111112,0.5555555555555556,0.3333333333333333,-0.35555555555555557,2.2222222222222223,0.0,1.3333333333333333,8.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.3,-0.16666666666666666,1.3333333333333333,0.3333333333333333,0.03333333333333333,-0.26666666666666666,2.1,-0.06666666666666667,2.4,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.3,0.6111111111111112,-0.1111111111111111,1.0,-0.35555555555555557,-0.4444444444444444,0.0,4.0,0.0,8.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.3,-0.16666666666666666,0.6666666666666666,1.0,0.03333333333333333,-0.13333333333333333,-0.7,-0.2,4.2,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
0.3,-0.16666666666666666,-0.3333333333333333,2.0,0.03333333333333333,0.06666666666666667,0.1,-0.4,-0.6,5.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]

l_stiffT0 = np.array(l_stiffT0).reshape(20,20)
l_stiffT1 = np.array(l_stiffT1).reshape(20,20)
l_stiffT2 = np.array(l_stiffT2).reshape(20,20)

# define dummy elastic star matrices
l_starEnzIds = [ (0,6), (1,6), (2,6), (3,7), (5,8), (6,0), (7,3), (8,5),
                 (0,7), (1,7), (2,7), (3,6), (4,8), (6,3), (7,1), (8,4),
                 (0,8), (1,8), (2,8), (4,7), (5,6), (6,5), (7,4), (8,2) ]

l_starMatE0 = np.zeros( (9,9) )
l_starMatE1 = np.zeros( (9,9) )
l_starMatE2 = np.zeros( (9,9) )

np.random.seed(3343)

for l_id in l_starEnzIds:
  l_starMatE0[ l_id ] = np.random.rand()
  l_starMatE1[ l_id ] = np.random.rand()
  l_starMatE2[ l_id ] = np.random.rand()

# define dummy viscous star matrices
l_starVnzIds = [ (0, 6), (1, 7), (2, 8),
                 (3, 6), (3, 7),
                 (4, 7),         (4, 8),
                 (5, 6),         (5, 8) ]

l_starMatV0 = np.zeros( (6,9) )
l_starMatV1 = np.zeros( (6,9) )
l_starMatV2 = np.zeros( (6,9) )

for l_id in l_starVnzIds:
  l_starMatV0[ l_id ] = np.random.rand()
  l_starMatV1[ l_id ] = np.random.rand()
  l_starMatV2[ l_id ] = np.random.rand()

# define dummy source matrices
l_srcNzIds = [ (0,0), (0,1), (0,2),
               (1,0), (1,1), (1,2),
               (2,0), (2,1), (2,2),
               (3,3), (4,4), (5,5) ]

l_srcMat0 = np.zeros( (9,6) )
l_srcMat1 = np.zeros( (9,6) )

for l_id in l_srcNzIds:
  l_srcMat0[ l_id ] = np.random.rand()
  l_srcMat1[ l_id ] = np.random.rand()

# omegas
l_oms = [ 0.012, 0.052 ]

# init dofs and tDofs
l_dofsE = np.random.rand( 9, 20 )
l_derE = np.zeros( (4, 9, 20) )
l_tDofsE = np.zeros( (9, 20) )

l_dofsV = np.random.rand( 2, 6, 20 )
l_derV = np.random.rand( 4, 2, 6, 20 )
l_tDofsV = np.zeros( (2, 6, 20) )

# compute elastic solution
l_dt = 0.017
l_sca = l_dt

l_derE[0] = l_dofsE
l_derV[0] = l_dofsV
l_tDofsE[:] = l_sca * l_derE[0]

for l_de in range(1,4):
  l_derE[l_de] =  np.matmul( l_starMatE0, np.matmul( l_derE[l_de-1], l_stiffT0 ) ) \
                + np.matmul( l_starMatE1, np.matmul( l_derE[l_de-1], l_stiffT1 ) ) \
                + np.matmul( l_starMatE2, np.matmul( l_derE[l_de-1], l_stiffT2 ) )

  l_sca *= -l_dt / (l_de+1)
  l_tDofsE += l_sca * l_derE[l_de]

def printCStyle( i_mat ):
  print( '{' )
  for l_ro in i_mat:
    print( '  {', end="" )
    for l_co in l_ro:
      print( l_co, end="," )
    print( '},' )
  print( '},' )

print('elastic solution:')
print( 'starMatE 0' )
printCStyle( l_starMatE0 )
print( 'starMatE 1' )
printCStyle( l_starMatE1 )
print( 'starMatE 2' )
printCStyle( l_starMatE2 )
print( 'dofsE' )
printCStyle( l_dofsE )
print( 'tDofsE' )
printCStyle( l_tDofsE )

# compute viscoelastic solution
l_dt = 0.017
l_sca = l_dt

l_derE[0] = l_dofsE
l_derV[0] = l_dofsV
l_tDofsE[:] = l_sca * l_derE[0]
l_tDofsV[:] = l_sca * l_derV[0]

for l_de in range(1,4):
  l_derE[l_de] = - np.matmul( l_starMatE0, np.matmul( l_derE[l_de-1], l_stiffT0 ) ) \
                 - np.matmul( l_starMatE1, np.matmul( l_derE[l_de-1], l_stiffT1 ) ) \
                 - np.matmul( l_starMatE2, np.matmul( l_derE[l_de-1], l_stiffT2 ) ) \
                 + np.matmul( l_srcMat0, l_derV[l_de-1, 0] ) \
                 + np.matmul( l_srcMat1, l_derV[l_de-1, 1] )

  for l_vi in range(2):
    l_derV[l_de, l_vi] = - np.matmul( l_starMatV0, np.matmul( l_derE[l_de-1], l_stiffT0 ) ) \
                         - np.matmul( l_starMatV1, np.matmul( l_derE[l_de-1], l_stiffT1 ) ) \
                         - np.matmul( l_starMatV2, np.matmul( l_derE[l_de-1], l_stiffT2 ) ) \
                         + l_derV[l_de-1, l_vi]
    l_derV[l_de, l_vi] *= l_oms[l_vi]
    
  l_sca *= l_dt / (l_de+1)
  l_tDofsE += l_sca * l_derE[l_de]
  l_tDofsV += l_sca * l_derV[l_de]

print('visocelastic solution:')
print( 'rfs' )
print( l_oms )
print( 'starMatV 0' )
printCStyle( l_starMatV0 )
print( 'starMatV 1' )
printCStyle( l_starMatV1 )
print( 'starMatV 2' )
printCStyle( l_starMatV2 )
print( 'srcMatV 0' )
printCStyle( l_srcMat0 )
print( 'srcMatV 1' )
printCStyle( l_srcMat1 )
print( 'dofsV 0' )
printCStyle( l_dofsV[0] )
print( 'dofsV 1' )
printCStyle( l_dofsV[1] )
print( 'tDofsE' )
printCStyle( l_tDofsE )
print( 'tDofsV 0' )
printCStyle( l_tDofsV[0] )
print( 'tDofsV 1' )
printCStyle( l_tDofsV[1] )
*/
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wunused-but-set-variable"

float l_rfs[2] = {0.012, 0.052};

float l_starE[3][9][9] = {
  {
    {0.0,0.0,0.0,0.0,0.0,0.0,0.31502566345387806,0.17661476441941415,0.5254352366074431,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.4324515724140714,0.145104758725479,0.041031159253460125,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.39985121899704656,0.5990846238512505,0.08073245532632756,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.5288961059771209,0.026977345180984713,0.0,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.12845718677742402,0.9129466698574331,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.35175193313938524,0.0,0.7065805011608832,},
    {0.32789142635669444,0.0,0.0,0.8246843537270405,0.0,0.10995184613860953,0.0,0.0,0.0,},
    {0.0,0.8825073057786866,0.0,0.04545564425537796,0.9716609168068608,0.0,0.0,0.0,0.0,},
    {0.0,0.0,0.675749791648789,0.0,0.7787644147790614,0.16271141716730497,0.0,0.0,0.0,},
  },
  {
    {0.0,0.0,0.0,0.0,0.0,0.0,0.6686942615102741,0.7092632178694926,0.38171894458920097,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.600432130975785,0.2839499700651775,0.9405131629213024,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.1543684265191141,0.9228883330076139,0.10697545851427537,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.8675113822389373,0.7876563493948178,0.0,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.21055395198417304,0.8834094321184481,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.855427863616338,0.0,0.0545912011591182,},
    {0.04383277467728808,0.0,0.0,0.7942610785991858,0.0,0.20956599868882875,0.0,0.0,0.0,},
    {0.0,0.5338618339303438,0.0,0.5915543218638859,0.39611007683105093,0.0,0.0,0.0,0.0,},
    {0.0,0.0,0.20563187445027964,0.0,0.4570543602158038,0.21032165415132298,0.0,0.0,0.0,},
  },
  {
    {0.0,0.0,0.0,0.0,0.0,0.0,0.5240257048836324,0.8300734026653475,0.13633714234056504,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.8142123084940156,0.18675814738620922,0.3193337700706066,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.5628388222969362,0.9162052839690623,0.852299854007144,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.9762351708589396,0.7019650033591671,0.0,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.8521368248412993,0.6444924751024506,},
    {0.0,0.0,0.0,0.0,0.0,0.0,0.7440056231049751,0.0,0.8062014187557345,},
    {0.7817780345840171,0.0,0.0,0.5273766966702069,0.0,0.40645785458234174,0.0,0.0,0.0,},
    {0.0,0.021139176990840447,0.0,0.38133187855089923,0.08272249318852198,0.0,0.0,0.0,0.0,},
    {0.0,0.0,0.6787477335595944,0.0,0.8613874091831872,0.27146748213875926,0.0,0.0,0.0,},
  },
};

float l_starA[3][6][3] = {
  {
    {0.23383889363393773,0.0,0.0,},
    {0.0,0.38216201131090644,0.0,},
    {0.0,0.0,0.4817278632059505,},
    {0.600785080814032,0.9662846252857071,0.0,},
    {0.0,0.04391413183260806,0.667924981950854,},
    {0.12066512003477525,0.0,0.13649699783111024,},
  },
  {
    {0.054742675839971056,0.0,0.0,},
    {0.0,0.08053171920572111,0.0,},
    {0.0,0.0,0.5319296537452306,},
    {0.5915212916928712,0.8548456926628406,0.0,},
    {0.0,0.6854049605932606,0.1867779476757424,},
    {0.07194010800992046,0.0,0.34686400793647265,},
  },
  {
    {0.9313589190382872,0.0,0.0,},
    {0.0,0.627140149419777,0.0,},
    {0.0,0.0,0.9748488015617851,},
    {0.3493547717613231,0.7735629263553444,0.0,},
    {0.0,0.8858152430736789,0.2183784080812342,},
    {0.9877663540141196,0.0,0.48207291480141023,},
  }
};

float l_srcA[2][6][6] = {
  {
    {0.18040568308983018,0.21149589716104722,0.959039808072128,0.0,0.0,0.0,},
    {0.6146223273627577,0.5717077682454518,0.588013308909576,0.0,0.0,0.0,},
    {0.5382228221440003,0.33178094323324814,0.2557777709740163,0.0,0.0,0.0,},
    {0.0,0.0,0.0,0.9208955092050831,0.0,0.0,},
    {0.0,0.0,0.0,0.0,0.7829178138909872,0.0,},
    {0.0,0.0,0.0,0.0,0.0,0.030568064537779716,}
  },
  {
    {0.8591711265668407,0.4882871365587155,0.23712759011787699,0.0,0.0,0.0,},
    {0.7449229369223274,0.9183068105773499,0.003488374932294258,0.0,0.0,0.0,},
    {0.9438779566985037,0.26353188237261727,0.6128992719943979,0.0,0.0,0.0,},
    {0.0,0.0,0.0,0.24962443209447138,0.0,0.0,},
    {0.0,0.0,0.0,0.0,0.46046315629073464,0.0,},
    {0.0,0.0,0.0,0.0,0.0,0.38293228138751845,}
  },
};

float l_dofsE[9][20] = {
  {0.9830231968674282,0.4037286258068854,0.4069948027631166,0.2277959888207005,0.8098198043973006,0.1351900414566426,0.431774226477032,0.00011263584762277734,0.8092104485716543,0.6899468018135323,0.29139289553906733,0.21429474020900952,0.7596166267147831,0.5484736726898856,0.303893702729475,0.0709296364975488,0.15811666250108958,0.5384484083804028,0.9796704261907097,0.07790227369938219,},
  {0.7018509328487825,0.64755685436897,0.4627554466815804,0.14159899383650387,0.6270481933191765,0.8948585225024033,0.5068923141542763,0.969433026272004,0.7900172144380949,0.906382464833375,0.6644718935395749,0.3386280685462211,0.4555936736348555,0.6955346001862238,0.49184935937873187,0.20291031311036145,0.6694835883812085,0.2465451468103259,0.631586345004049,0.011501585806741654,},
  {0.2254339684489649,0.4488480946430653,0.49887214953450654,0.758857498301866,0.8512384172747164,0.43713128112216526,0.28016403128520895,0.1375727172474821,0.3009910633719367,0.8383426781896217,0.015928517756633953,0.8047229312927168,0.36847243298558086,0.2071642372269613,0.8149361069563443,0.6676679744075215,0.9419038278203408,0.7816567304164916,0.9834524241793263,0.14136779901191754,},
  {0.7558668914987101,0.12263826700878122,0.49544525749360924,0.07665999408482171,0.49595693030545496,0.274403255653635,0.006253078678332802,0.6188911571113302,0.46489404080650176,0.6331766037263096,0.08535184011563535,0.8428811439758886,0.6653358742494558,0.0934694593163583,0.09552835506920088,0.018331698749472825,0.34309146081596764,0.2806300115303154,0.9795058821300665,0.5629753986334924,},
  {0.7512406248101109,0.9686878804243347,0.14560756659794327,0.25506879441240593,0.720779339052024,0.5685482829680449,0.5856170265288826,0.48119938998248835,0.9225578689888816,0.8569518963608754,0.48657002011878303,0.20080274974575352,0.572476437935921,0.6524285499354338,0.7732328922028542,0.4885637273705874,0.2108611303959117,0.06615849565711673,0.5743819875500165,0.3976665466913717,},
  {0.576261438247496,0.07185322745174405,0.7993315995414616,0.23379657726538283,0.6712607827596982,0.39745311601819144,0.5276788032882803,0.2588731105242157,0.10192504829305782,0.4571675606591682,0.09549208226775685,0.03973454106198293,0.8005990272394885,0.01927470528805242,0.13255847506360252,0.16935820806987623,0.6108038044003051,0.12032898633921518,0.5052000261675985,0.3362475688030221,},
  {0.5086366947462733,0.9538025451314955,0.09727388896073141,0.07313528972100236,0.860379502155309,0.5803009213865201,0.12118162942077759,0.22037585076031863,0.6803784633987648,0.9186181359189483,0.27515375420618904,0.1765628078786986,0.42255059300863784,0.9338891610943436,0.14470539491774703,0.5429045627015319,0.5706372442164516,0.5734094636554303,0.6600787664414439,0.20933842129341806,},
  {0.5002995902221733,0.7801339420875241,0.4456128919476785,0.9115627153041054,0.4678510355491027,0.5803315666446759,0.9157128090981275,0.7073440914043501,0.5242132010356504,0.2879616893912367,0.5571967910574841,0.7906479546119951,0.3430092473837858,0.4372457224854528,0.6955246348143972,0.974120324288659,0.9009975874561089,0.43343752159194326,0.03614922300599799,0.8908601976322653,},
  {0.9555312097043612,0.5917090823067621,0.6404651709150618,0.3280739619426897,0.8741367345796872,0.6769606765745706,0.08350988205426857,0.40464149214340794,0.1490034959183678,0.15126720667047366,0.4905129613408312,0.00039029606773943737,0.9840890392841251,0.030582857605681912,0.019313113008287863,0.5425988893678727,0.8609661341186937,0.21144911987650605,0.010661721517663647,0.9827667631143463,},
};

float l_dofsA[2][6][20] = {
  {
    {0.9445343052040858,0.11475512962501033,0.5427206463855078,0.15660504620648497,0.1361806330367762,0.894012978552536,0.18369474969582655,0.5736409713280851,0.620717094436384,0.2775798434829321,0.12896129085350738,0.9569240110402756,0.04155717639518519,0.0482133552395414,0.680345651922374,0.28329690946959774,0.7018870002444677,0.5997917812937408,0.2663867898184734,0.8024712740559365,},
    {0.4524335691208976,0.5368669939689092,0.013224465478016145,0.8644416930234293,0.31101980741438684,0.08483719166593284,0.4826683272076172,0.38278663363632925,0.8322677001692974,0.7714233275330086,0.8964991217883438,0.368277101055544,0.6101090288191946,0.33591870942558466,0.9638146297236853,0.785464381447578,0.6751567702334668,0.7011869496238655,0.8467802607982031,0.7034416705020814,},
    {0.5947632606865692,0.12140688892038554,0.3667942689742937,0.9112686422510718,0.5983681883738042,0.6352100183766681,0.6842408412420093,0.4069258631210021,0.6811702757845521,0.01502693265639743,0.17802988669379194,0.4797616091622243,0.6356313090305482,0.25784564110232877,0.43321954575916655,0.008610538576318438,0.30112453945880846,0.6562265448765717,0.31695495666209095,0.5804014939940874,},
    {0.15644295356607418,0.14868683426073204,0.6357891958073453,0.8707758558886078,0.3939352121662908,0.7089169646749649,0.5672655142625588,0.5425784005549168,0.9479758298066434,0.697240612499603,0.8032863322169681,0.10218219597790013,0.18576629467195627,0.19785565631887336,0.6309635750304853,0.017515729563623905,0.7084372751352906,0.5536942721886766,0.5201123919488356,0.3213928248954766,},
    {0.1166517156262098,0.07792400762412133,0.09841102418372794,0.884417857258409,0.6696196824886426,0.3605365951273276,0.894578167536445,0.04805053526224545,0.5364532036339619,0.7185295401951468,0.021723619379649062,0.3095269771719926,0.38447959978308033,0.5719665362775948,0.06956128054303101,0.768928617162076,0.04833335085377044,0.30897783293114744,0.6310753919962865,0.6733076657827068,},
    {0.1754975008953501,0.45597952452664137,0.1669559625204443,0.36979982071014383,0.19379862018052874,0.6239368427228148,0.8468388444017927,0.19234139078195622,0.8144673954714964,0.1687491071566778,0.9909871917334613,0.4780618020757581,0.474719345429111,0.15295893250412818,0.32173812550513003,0.8447354194944613,0.05021250849051728,0.3572441571635475,0.8109178140165463,0.706101626579549,},
  },
  {
    {0.5446212644595511,0.17233219243234166,0.6472579601456072,0.30355120970912586,0.41070060099176675,0.5559348959228195,0.5159591957004569,0.1096849540132333,0.6314490803181747,0.05208379452808731,0.05485738887289926,0.9411403862097424,0.5332405898032233,0.6931362926433794,0.060035523504603616,0.09105270485651695,0.6976147062133821,0.5330013257867603,0.8645862545017974,0.03540712407065327,},
    {0.6987495425657437,0.9500755955882899,0.27768238924012956,0.1674944813382926,0.6206782487304486,0.861267500307749,0.7115668641774274,0.8379016726998958,0.24088721049627182,0.4318101264702596,0.41524593336678695,0.9688132161645737,0.24754652676301026,0.9718934760112893,0.7164147301097085,0.4448939530485726,0.12894574018399496,0.32621149882005807,0.5482287300154562,0.685694344312362,},
    {0.4638484842010765,0.9435516371062797,0.7325926015892662,0.4348011553875396,0.24066985756768922,0.21082966281640292,0.5142598640448854,0.8700407075597396,0.37200592094184204,0.6186648885155009,0.4361547760251353,0.5218533517315908,0.006167867793398396,0.9484632251200636,0.7666229742182246,0.589697396935022,0.7109263843494841,0.4680067700571925,0.11579432151278268,0.6141011867302728,},
    {0.0920812054008866,0.48819108279960266,0.012937441142086059,0.954218821610174,0.5694453288118575,0.8330046097513446,0.2069028989815157,0.6302804994734054,0.6340596143477064,0.7862371934027583,0.7849911932583787,0.19031963139832397,0.9524884497508523,0.23439669066834345,0.6875201765053258,0.2478464799452773,0.645342234877958,0.2899723343809192,0.0693027983874821,0.0858703330475934,},
    {0.49108924135237175,0.15289367771238904,0.886653790969967,0.9306334720222659,0.9433430118590203,0.7480309399496365,0.9726623031603704,0.7658607639974325,0.7110047663970029,0.6353096503377826,0.4439741672318973,0.6516957650964602,0.5269153986822442,0.4726915865922885,0.657116064417069,0.567771077567296,0.014748376618127779,0.05618691456223979,0.987950709420194,0.6133262869432756,},
    {0.8613690303165805,0.8490062547338375,0.67012220218093,0.05245501090559779,0.1380048279322913,0.41583918240965734,0.15766481378059172,0.42957445409791617,0.5579063052099505,0.8345636002121606,0.8640805408422473,0.0033323734380261705,0.5175920519433239,0.7361469286539122,0.14466720482545414,0.02770417099269562,0.7305384285166829,0.23941902502639711,0.6431203571023046,0.45765719295536555,},
  }
};

float l_refEtDofs[9][20] = {
  {0.013992479780934007,0.004400294301783674,0.00425976806905658,0.0014216444748536207,0.011627500306233721,-0.0011528694374665712,0.0033979627311904346,-0.003537642418300676,0.009768728393408747,0.007793609350531593,0.004953679224164145,0.003643010583553162,0.012913482654151315,0.009324052435728055,0.005166192946401076,0.0012058038204583296,0.002687983262518523,0.009153622942466848,0.016654397245242064,0.0013243386528894972,},
  {0.009853883594144547,0.008912684656652462,0.005585608392962183,0.00023412506764013336,0.009348086144178052,0.012144014731260455,0.005253868222206659,0.013846381432225309,0.009715372472585887,0.012409257778975287,0.011296022190172774,0.005756677165285759,0.007745092451792544,0.011824088203165805,0.008361439109438443,0.003449475322876145,0.011381221002480546,0.004191267495775541,0.010736967865068833,0.00019552695871460815,},
  {0.0006742344701326494,0.004244875830779109,0.00502197706211298,0.010088700880077423,0.011505035188638775,0.0038266418202279767,0.0003099595672896773,-0.0012552725460748381,0.0008723613731524259,0.01003345974241119,0.00027078480186277723,0.013680289831976186,0.006264031360754875,0.0035217920328583425,0.013853913818257855,0.011350355564927866,0.016012365072945796,0.01328816441708036,0.016718691211048547,0.0024032525832025984,},
  {0.010269632216204378,-0.0005118653660754191,0.005722731889108835,-0.0016259837405923345,0.00628640959586277,0.0017769285189276453,-0.004017621257993636,0.006960078728926188,0.0035775246947455652,0.007628012063277768,0.001450981281965801,0.014328979447590108,0.01131070986224075,0.0015889808083780913,0.001623982036176415,0.00031163887874103804,0.00583255483387145,0.004770710196015362,0.01665159999621113,0.009570581776769373,},
  {0.010557853217619807,0.014625538051690886,0.000445694584106579,0.0030526384631362046,0.010495826632745153,0.0062523263428339824,0.007152566842129752,0.005811405402417402,0.012869101318550336,0.010730291107242667,0.008271690342019312,0.00341364674567781,0.009732099444910656,0.011091285348902375,0.013144959167448522,0.008305583365299987,0.003584639216730499,0.0011246944261709847,0.00976449378835028,0.006760331293753319,},
  {0.008073586460379326,-0.0006628896199336186,0.011681880572567926,0.0017365881696385628,0.01032226393295845,0.004866122431130949,0.0050831008135311835,0.002632698376380513,-0.0011123043027716968,0.004474742819681866,0.0016233653985518665,0.0006754871980537098,0.013610183463071305,0.0003276699898968911,0.002253494076081243,0.002879089537187896,0.010383664674805188,0.002045592767766658,0.008588400444849176,0.0057162086696513755,},
  {0.007475757513616448,0.01434699354920807,0.0004593432804519184,-0.0012265606127544626,0.013185287046133708,0.007501765293012309,-0.0002004006184825641,0.0023741989626601735,0.007910127718234222,0.012254912421353386,0.004677613821505214,0.0030015677339378763,0.007183360081146844,0.01587611573860384,0.0024599917136016998,0.009229377565926043,0.009700833151679676,0.009747960882142316,0.011221339029504547,0.0035587531619881074,},
  {0.0067909680221441724,0.011144795673836186,0.005732106839339683,0.012229724267371051,0.006257243465818884,0.007702920057696473,0.013500380042918848,0.011069897659503445,0.005712510139693788,0.0023913376481399062,0.00947234544797723,0.013441015228403918,0.005831157205524359,0.007433177282252698,0.011823918791844754,0.016560045512907205,0.015316958986753853,0.007368437867063036,0.0006145367911019659,0.015144623359748512,},
  {0.0140862532573734,0.00735559275182633,0.008404444569386296,0.0028929607813401098,0.012742323351792777,0.00862029444863734,-0.0014827521094815078,0.003594059851951224,-0.0018948679399716341,-0.0001615301136357961,0.00833872034279413,6.635033151570436e-06,0.016729513667830126,0.0005199085792965926,0.0003283229211408937,0.009224181119253837,0.014636424280017794,0.0035946350379006033,0.000181249265800282,0.016707034972943888,},
};

float l_refVtDofsE[9][20] = {
  {0.0142485295062113,0.004559362542454503,0.004453057067622103,0.0016471000613574752,0.011826176102136397,-0.0009024344986936855,0.0036435239075795567,-0.003352475125213054,0.010012221826970069,0.007883928630550966,0.005060183623627682,0.003948845145001299,0.013105209811110552,0.009558492719839417,0.005357722283598546,0.0013013084537673947,0.002888752109778775,0.009386893309496972,0.016881181515598486,0.0015210376543708238,},
  {0.010179243733437685,0.009124632300091789,0.005775646551395068,0.00045565851443272613,0.009563011049141912,0.012458101290779112,0.005517776536063534,0.01408643497242286,0.009996583774908653,0.012561432005976645,0.011457914694923603,0.006143056883805258,0.007943477800335615,0.012082147388150876,0.008640250491096743,0.0036094161620797214,0.01161751757148032,0.004459157995044598,0.011023439569947242,0.0004693742987934887,},
  {0.0009359826945008151,0.004429681132925885,0.005245396990520183,0.010267140821426957,0.011653271237115367,0.004050447513985052,0.0005148772112424028,-0.0010537795267083975,0.0011132066001234748,0.010170126891460064,0.000392319392826804,0.014001643296339381,0.006402736286217561,0.0037667887505177687,0.014072448800466668,0.011491978208180112,0.016273526585039742,0.013519294181273402,0.01694082229491149,0.0026062006034182883,},
  {0.01029587753030176,-0.0004723396066520381,0.0058105053200818765,-0.0014719008185810941,0.00635907815226548,0.0019009053285757782,-0.003935161249364423,0.007054530272977286,0.00372607553861778,0.007748664511528733,0.0015862049332921564,0.014349444687320592,0.011369798433048858,0.0016237684842568933,0.0017327563550279424,0.0003229124833578171,0.005950117395104299,0.00485485756833563,0.016723316286623654,0.009616450554371285,},
  {0.010605920374355576,0.014646573765841803,0.0005185930458500443,0.0032187595361220594,0.01063403157533894,0.006342443974936709,0.007318087368636947,0.005867371424844498,0.012976680226870155,0.010853333694805328,0.008303697520413147,0.0034920410296694626,0.009810668868437514,0.01118745796731937,0.013196564652662437,0.008430368300735742,0.0035910892199248023,0.0011633915737332594,0.009901647805041597,0.006877329736977666,},
  {0.008124088262548446,-0.0006118468989762883,0.01172246343282431,0.001744640095212376,0.010330661326292895,0.004891730655915553,0.005095313270659634,0.002657200978918688,-0.001078069171212297,0.004521463146301271,0.0016755698492429032,0.0006777834283705912,0.013640929213637581,0.00036909141812602143,0.0022629226506296982,0.0028843544858616326,0.010424321801836786,0.0020604227016042635,0.008627579308334889,0.005744659129158918,},
  {0.00745208654727428,0.01432659393623615,0.00043357359583724367,-0.001250762064218887,0.013164794090952557,0.007481432643028747,-0.0002246578778184948,0.002349017357157316,0.007884877400965678,0.012227281445281,0.004677613821505214,0.0030015677339378763,0.007183360081146844,0.01587611573860384,0.0024599917136016998,0.009229377565926043,0.009700833151679676,0.009747960882142316,0.011221339029504547,0.0035587531619881074,},
  {0.006764652923409199,0.011120248772384846,0.005703346183372409,0.012196307645034574,0.006236742639297323,0.007684975453095065,0.013478928086237872,0.011044578978820259,0.00567689273645186,0.002351911848337589,0.00947234544797723,0.013441015228403918,0.005831157205524359,0.007433177282252698,0.011823918791844754,0.016560045512907205,0.015316958986753853,0.007368437867063036,0.0006145367911019659,0.015144623359748512,},
  {0.0140611389374986,0.0073309593659224,0.008377437579715267,0.0028619682862171536,0.012722804267415552,0.008591505934736399,-0.0015096854424760079,0.003566061135112687,-0.0019306813201070262,-0.0001995845039572274,0.00833872034279413,6.635033151570436e-06,0.016729513667830126,0.0005199085792965926,0.0003283229211408937,0.009224181119253837,0.014636424280017794,0.0035946350379006033,0.000181249265800282,0.016707034972943888,},
};

float l_refVtDofsA[2][6][20] =  {
  {
    {0.01605017945575103,0.0019395239364694186,0.009215633020670383,0.0026506275515306155,0.002309903708907583,0.015192692812640397,0.0031076676826489176,0.009743919885813085,0.010536811026883555,0.004707786398687577,0.0021925655785948244,0.016269367606758407,0.0007065440637623572,0.0008197106467154123,0.011567055882265798,0.00481653873122999,0.011933296158979497,0.010197500391668612,0.0045290373730193945,0.013643403238765955,},
    {0.007680004718717721,0.009118586558444936,0.00021602223284186803,0.014690102635352436,0.005276543543965727,0.001427918404505953,0.0081954071607969,0.006494677320429495,0.014138378814807838,0.013100318514714573,0.015242039705592424,0.006261349353863983,0.010372911490925125,0.005711200582887951,0.0163865200735217,0.013354256572466658,0.011478835895421665,0.011921394084458935,0.014396732850392323,0.01195972824934048,},
    {0.010100918193739091,0.0020510670435050734,0.006222687130523528,0.01548479006344885,0.010164550214870859,0.01078147652075797,0.011611296654153013,0.006910614561419229,0.011564922491299912,0.0002314881259755663,0.0030268167986109208,0.008156779318960637,0.01080683451316156,0.004383823033485907,0.007365483531682567,0.0001463940874866424,0.005119639356259174,0.011156989237111468,0.0053887839005250975,0.009867831882529862,},
    {0.002626367717551895,0.0024969547190312586,0.010775775380223326,0.014772831003281469,0.006670963003322885,0.012015747979286059,0.009600780066600374,0.009181128395832521,0.01607475808296703,0.011809911121967793,0.013657260640910452,0.0017372745276012496,0.0031583491500834105,0.0033638892624596505,0.010727474940759325,0.00029779777692208974,0.012044662191072543,0.009413762798366006,0.008842812599348465,0.005464235356279475,},
    {0.0019605336299789175,0.0013047813117929698,0.0016513238150519733,0.01502235710935204,0.011363037343945689,0.00610055854519244,0.015182167208833518,0.0007887798952847269,0.009092876557196984,0.012182246279545079,0.0003693392007716445,0.005262495368201098,0.0065368199292754605,0.009724422974138175,0.001182662396694517,0.013073119904647986,0.0008217507802438508,0.005253158963825861,0.01072937602308175,0.011447397913193587,},
    {0.0029693925217816578,0.007733846839203588,0.002820372470096359,0.006271947438882131,0.003284757810414179,0.010590817109157435,0.01437109346662724,0.003257190580850539,0.013822006478417493,0.002846243654999477,0.01684850074811455,0.008127879650824786,0.008071052091617825,0.002600567101395755,0.005470106065435558,0.01436196700223277,0.0008536997187494756,0.0060737701752743515,0.013787009065392609,0.012004952115334925,},
  },
  {
    {0.009225632529917836,0.0028810444959501144,0.010958148952118002,0.005110944115248069,0.0069615779298496175,0.009424392834009383,0.008708168884792653,0.0018265838061632671,0.010668055079754673,0.0008357446783403507,0.0009329879307472558,0.016006460378690895,0.009069097977369003,0.011788526736070164,0.0010210551394574255,0.0015485803542317346,0.011864693427477735,0.009065028690729436,0.014704464742372273,0.0006021872367445083,},
    {0.011831329758808812,0.01611905587502562,0.00468447340926003,0.0028187355186599966,0.010507076628579014,0.014585342559947046,0.012055211621274854,0.014192723083226323,0.004046548594164048,0.007278067679007823,0.007062301944788426,0.01647710648285196,0.004210151567793438,0.0165294940521402,0.01218443513872965,0.007566541120257611,0.002193046766984783,0.005548047355575887,0.009324009015055472,0.01166195767916206,},
    {0.007840848581427862,0.015990860370462035,0.01240127658801045,0.00735866442354254,0.004055285855315848,0.0035068246435913295,0.008650996506348438,0.014763290415443229,0.00625688268084897,0.010417947802325665,0.0074179094253291125,0.008875429341226036,0.00010490011150582274,0.016131003680195197,0.013038352664512566,0.010029288040088442,0.01209109200922122,0.007959632730297133,0.0019693738006889543,0.010444335890729217,},
    {0.0014211593928522804,0.008168643015882833,7.377760224385057e-05,0.016090762160613163,0.009569476666598601,0.014006667337223437,0.0033294194753286477,0.010530333266127444,0.010599679432712695,0.013179548525995344,0.013350750447671582,0.0032368642169664794,0.016199462753370798,0.003986505517193868,0.01169301054978906,0.00421525302640447,0.010975668523662533,0.004931709178773147,0.0011786684672932723,0.0014604410816613056,},
    {0.00825361149275336,0.0025133862703458337,0.014985141239064774,0.015765868233210124,0.015950046975023842,0.01259563492975755,0.016424620403367594,0.012903324066625688,0.011972112386235315,0.010657664127369999,0.007550897848066533,0.011083726291873753,0.008961522186818416,0.008039309823480273,0.011175912120457071,0.009656375807915021,0.00025083325447205183,0.0009555998604664615,0.016802587709704,0.010431156770037161,},
    {0.014587466170560393,0.01435888697802779,0.01131836565018654,0.000825853397481226,0.002303105229083422,0.006997879560664689,0.002566040614282498,0.007249879819006385,0.009378718575307476,0.014095101790189272,0.014695863809107522,5.667539528038128e-05,0.008802955215981755,0.01252003082542019,0.002460429831791891,0.0004711791373707278,0.012424644168396594,0.0040719229502236805,0.010937879901366215,0.0077836121299234085,},
  },
};

// extract elastic sparse star-matrices (compressed rows)
float l_starSpE[3][24];
unsigned short l_nz = 0;
for( unsigned short l_ro = 0; l_ro < 9; l_ro++ ) {
  for( unsigned short l_co = 0; l_co < 9; l_co++ ) {
    if( l_starE[0][l_ro][l_co] != 0.0f ) {
      EDGE_CHECK_NE( l_starE[1][l_ro][l_co], 0.0f );
      EDGE_CHECK_NE( l_starE[2][l_ro][l_co], 0.0f );

      for( unsigned short l_di = 0; l_di < 3; l_di++ )
        l_starSpE[l_di][l_nz] = l_starE[l_di][l_ro][l_co];

      l_nz++;
    }
  }
}
EDGE_CHECK_EQ( l_nz, 24 );

// extract anelastic sparse star matrices (compressed rows)
float l_starSpA[3][9];

l_nz = 0;

for( unsigned short l_ro = 0; l_ro < 6; l_ro++ ) {
  for( unsigned short l_co = 0; l_co < 3; l_co++ ) {
    if( l_starA[0][l_ro][l_co] != 0.0f ) {
      EDGE_CHECK_NE( l_starA[1][l_ro][l_co], 0.0f );
      EDGE_CHECK_NE( l_starA[2][l_ro][l_co], 0.0f );

      for( unsigned short l_di = 0; l_di < 3; l_di++ )
        l_starSpA[l_di][l_nz] = l_starA[l_di][l_ro][l_co];

      l_nz++;
    }
  }
}
EDGE_CHECK_EQ( l_nz, 9 );

// extract anelastic sparse source matrices (compress rows)
float l_srcSpA[2][12];

l_nz = 0;
for( unsigned short l_ro = 0; l_ro < 6; l_ro++ ) {
  for( unsigned short l_co = 0; l_co < 6; l_co++ ) {
    if( l_srcA[0][l_ro][l_co] != 0.0f ) {
      EDGE_CHECK_NE( l_srcA[1][l_ro][l_co], 0.0f );
      for( unsigned short l_rm = 0; l_rm < 2; l_rm++ )
        l_srcSpA[l_rm][l_nz] = l_srcA[l_rm][l_ro][l_co];

      l_nz++;
    }
  }
}
EDGE_CHECK_EQ( l_nz, 12 );

#pragma GCC diagnostic pop