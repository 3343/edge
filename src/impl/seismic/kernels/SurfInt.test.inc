/**
 * @file This file is part of EDGE.
 *
 * @author Alexander Breuer (anbreuer AT ucsd.edu)
 *
 * @section LICENSE
 * Copyright (c) 2019, Alexander Breuer
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
 *
 * 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * @section DESCRIPTION
 * Third order reference solution for the surface integration unit tests.
 **/

// python code of the reference solution
/*
import numpy as np
# define raw flux matrices (generated by EDGEpre)
l_fIntL = [
0.5,0.0,0.0,0.0,0.0,0.0,
-0.5,0.0,0.0,0.0,0.0,0.0,
0.0,-0.125,0.125,0.0,0.0,0.0,
0.0,0.125,0.041666666666666664,0.0,0.0,0.0,
0.5,0.0,0.0,0.0,0.0,0.0,
0.0,0.125,-0.125,0.0,0.0,0.0,
0.0,0.0,0.0,0.05555555555555555,-0.05555555555555555,0.05555555555555555,
0.0,-0.125,-0.041666666666666664,0.0,0.0,0.0,
0.0,0.0,0.0,-0.05555555555555555,0.027777777777777776,0.027777777777777776,
0.0,0.0,0.0,0.05555555555555555,0.027777777777777776,0.005555555555555556,

0.5,0.0,0.0,0.0,0.0,0.0,
0.16666666666666666,0.3333333333333333,0.0,0.0,0.0,0.0,
-0.3333333333333333,0.08333333333333333,0.0,0.0,0.0,0.0,
0.0,0.0,0.08333333333333333,0.0,0.0,0.0,
0.08333333333333333,0.16666666666666666,0.0,0.25,0.0,0.0,
-0.16666666666666666,-0.18333333333333332,0.0,0.1,0.0,0.0,
0.25,-0.1,0.0,0.016666666666666666,0.0,0.0,
0.0,0.0,0.016666666666666666,0.0,0.06666666666666667,0.0,
0.0,0.0,-0.06666666666666667,0.0,0.011111111111111112,0.0,
0.0,0.0,0.0,0.0,0.0,0.03333333333333333,

0.5,0.0,0.0,0.0,0.0,0.0,
0.16666666666666666,-0.16666666666666666,0.16666666666666666,0.0,0.0,0.0,
0.16666666666666666,0.20833333333333334,0.041666666666666664,0.0,0.0,0.0,
-0.16666666666666666,0.041666666666666664,0.041666666666666664,0.0,0.0,0.0,
0.08333333333333333,-0.08333333333333333,0.08333333333333333,0.08333333333333333,-0.08333333333333333,0.08333333333333333,
0.08333333333333333,-0.008333333333333333,0.058333333333333334,-0.11666666666666667,0.06666666666666667,0.03333333333333333,
0.08333333333333333,0.11666666666666667,0.016666666666666666,0.10555555555555556,0.03888888888888889,0.005555555555555556,
-0.08333333333333333,0.058333333333333334,-0.041666666666666664,-0.016666666666666666,0.0,0.03333333333333333,
-0.08333333333333333,-0.06666666666666667,0.0,0.03888888888888889,0.027777777777777776,0.005555555555555556,
0.08333333333333333,-0.03333333333333333,-0.03333333333333333,0.005555555555555556,0.005555555555555556,0.005555555555555556,

0.5,0.0,0.0,0.0,0.0,0.0,
0.16666666666666666,0.3333333333333333,0.0,0.0,0.0,0.0,
0.16666666666666666,-0.041666666666666664,0.125,0.0,0.0,0.0,
0.16666666666666666,-0.041666666666666664,-0.041666666666666664,0.0,0.0,0.0,
0.08333333333333333,0.16666666666666666,0.0,0.25,0.0,0.0,
0.08333333333333333,0.09166666666666666,0.025,-0.05,0.1,0.0,
0.08333333333333333,-0.03333333333333333,0.06666666666666667,0.005555555555555556,-0.011111111111111112,0.05555555555555555,
0.08333333333333333,0.09166666666666666,-0.008333333333333333,-0.05,-0.03333333333333333,0.0,
0.08333333333333333,-0.03333333333333333,0.03333333333333333,0.005555555555555556,-0.005555555555555556,-0.027777777777777776,
0.08333333333333333,-0.03333333333333333,-0.03333333333333333,0.005555555555555556,0.005555555555555556,0.005555555555555556,

]

l_fIntN6 = [0.5,0.0,0.0,0.0,0.0,0.0,
0.16666666666666666,-0.16666666666666666,-0.16666666666666666,0.0,0.0,0.0,
0.16666666666666666,0.20833333333333334,-0.041666666666666664,0.0,0.0,0.0,
-0.16666666666666666,0.041666666666666664,-0.041666666666666664,0.0,0.0,0.0,
0.08333333333333333,-0.08333333333333333,-0.08333333333333333,0.08333333333333333,0.08333333333333333,0.08333333333333333,
0.08333333333333333,-0.008333333333333333,-0.058333333333333334,-0.11666666666666667,-0.06666666666666667,0.03333333333333333,
0.08333333333333333,0.11666666666666667,-0.016666666666666666,0.10555555555555556,-0.03888888888888889,0.005555555555555556,
-0.08333333333333333,0.058333333333333334,0.041666666666666664,-0.016666666666666666,0.0,0.03333333333333333,
-0.08333333333333333,-0.06666666666666667,0.0,0.03888888888888889,-0.027777777777777776,0.005555555555555556,
0.08333333333333333,-0.03333333333333333,0.03333333333333333,0.005555555555555556,-0.005555555555555556,0.005555555555555556,]

l_fIntT = [
6.0,-10.0,0.0,0.0,14.0,0.0,0.0,0.0,0.0,0.0,
0.0,0.0,-10.0,30.0,0.0,14.0,0.0,-42.0,0.0,0.0,
0.0,0.0,30.0,30.0,0.0,-42.0,0.0,-42.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,14.0,0.0,-42.0,70.0,
0.0,0.0,0.0,0.0,0.0,0.0,-42.0,0.0,63.0,105.0,
0.0,0.0,0.0,0.0,0.0,0.0,70.0,0.0,105.0,35.0,

6.0,3.3333333333333335,-13.333333333333334,0.0,2.3333333333333335,-9.333333333333334,21.0,0.0,0.0,0.0,
0.0,13.333333333333334,6.666666666666667,0.0,9.333333333333334,-20.533333333333335,-16.8,0.0,0.0,0.0,
0.0,0.0,0.0,60.0,0.0,0.0,0.0,16.8,-100.8,0.0,
0.0,0.0,0.0,0.0,21.0,16.8,4.2,0.0,0.0,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,100.8,25.2,0.0,
0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,210.0,

6.0,3.3333333333333335,6.666666666666667,-20.0,2.3333333333333335,4.666666666666667,7.0,-14.0,-21.0,35.0,
0.0,-6.666666666666667,16.666666666666668,10.0,-4.666666666666667,-0.9333333333333333,19.6,19.6,-33.6,-28.0,
0.0,20.0,10.0,30.0,14.0,19.6,8.4,-42.0,0.0,-84.0,
0.0,0.0,0.0,0.0,7.0,-19.6,26.6,-8.4,29.4,7.0,
0.0,0.0,0.0,0.0,-21.0,33.6,29.4,0.0,63.0,21.0,
0.0,0.0,0.0,0.0,35.0,28.0,7.0,84.0,21.0,35.0,

6.0,3.3333333333333335,6.666666666666667,20.0,2.3333333333333335,4.666666666666667,7.0,14.0,21.0,35.0,
0.0,13.333333333333334,-3.3333333333333335,-10.0,9.333333333333334,10.266666666666667,-5.6,30.8,-16.8,-28.0,
0.0,0.0,30.0,-30.0,0.0,8.4,33.6,-8.4,50.4,-84.0,
0.0,0.0,0.0,0.0,21.0,-8.4,1.4,-25.2,4.2,7.0,
0.0,0.0,0.0,0.0,0.0,50.4,-8.4,-50.4,-12.6,21.0,
0.0,0.0,0.0,0.0,0.0,0.0,70.0,0.0,-105.0,35.0,
]

l_fIntL = np.array(l_fIntL).reshape(4,10,6)
l_fIntN6 = np.array(l_fIntN6).reshape(10,6)
l_fIntT = np.array(l_fIntT).reshape(4,6,10)

# init random data structures
np.random.seed(3343)
l_fSolv       = np.random.rand( 4,9,9 )
l_dofs        = np.random.rand( 9, 10 )
l_dofsLocal   = np.zeros( (9, 10) )
l_tDofs       = np.random.rand( 9, 10 )
l_dofsNeigh   = np.zeros( (9, 10) )
l_dofsNeighFs = np.zeros( (9, 10) )

# local
l_dofsLocal[:] = l_dofs
for l_fa in range(4):
  l_dofsLocal += np.matmul( np.matmul( l_fSolv[l_fa], np.matmul( l_tDofs, l_fIntL[l_fa] ) ), l_fIntT[l_fa] )

# neighboring (fa: 3, vId: 1, fId: 2)
l_dofsNeigh[:] = l_dofs
l_dofsNeigh += np.matmul( np.matmul( l_fSolv[0], np.matmul( l_tDofs, l_fIntN6 ) ), l_fIntT[3] )

# neighboring (free surface, face 2)
l_dofsNeighFs[:] = l_dofs
l_dofsNeighFs += np.matmul( np.matmul( l_fSolv[0], np.matmul( l_tDofs, l_fIntL[2] ) ), l_fIntT[2] )

def printCStyle( i_mat ):
  print( '{' )
  for l_ro in i_mat:
    print( '  {', end="" )
    for l_co in l_ro:
      print( l_co, end="," )
    print( '},' )
  print( '},' )

for l_fa in range(4):
  print( 'fSolv ' + str(l_fa) )
  printCStyle( l_fSolv[l_fa] )

print( 'elastic solution' )
print( 'dofs' )
printCStyle( l_dofs )
print( 'tDofs' )
printCStyle( l_tDofs )
print( 'dofsLocal' )
printCStyle( l_dofsLocal )
print( 'dofsNeigh' )
printCStyle( l_dofsNeigh )
print( 'dofsNeighFs' )
printCStyle( l_dofsNeighFs )

# compute viscoelastic solution
l_fSolvA = np.random.rand( 4,6,9 )
l_dofsA = np.random.rand( 3, 6, 10 )
l_dofsLocalA = np.zeros( (3, 6, 10) )
l_dofsNeighA   = np.zeros( (6, 10) )
l_dofsNeighFsA = np.zeros( (6, 10) )

# local
l_dofsLocalA[:] = l_dofsA
l_rfs = [0.0142, 0.0512, 0.252]
for l_rm in range(3):
  for l_fa in range(4):
    l_dofsLocalA[l_rm] += l_rfs[l_rm] * np.matmul( np.matmul( l_fSolvA[l_fa], np.matmul( l_tDofs, l_fIntL[l_fa] ) ), l_fIntT[l_fa] )

# neighboring (fa: 3, vId: 1, fId: 2)
l_dofsNeighA += np.matmul( np.matmul( l_fSolvA[0], np.matmul( l_tDofs, l_fIntN6 ) ), l_fIntT[3] )

# neighboring (free surface, face 2)
l_dofsNeighFsA += np.matmul( np.matmul( l_fSolvA[0], np.matmul( l_tDofs, l_fIntL[2] ) ), l_fIntT[2] )

print( l_rfs )
for l_fa in range(4):
  print( 'fSolvA ' + str(l_fa) )
  printCStyle( l_fSolvA[l_fa] )
print( 'viscoelastic solution' )
print( 'dofslA 0' )
printCStyle( l_dofsA[0] )
print( 'dofsA 1' )
printCStyle( l_dofsA[1] )
print( 'dofsA 2' )
printCStyle( l_dofsA[2] )

print( 'dofsLocalA 0' )
printCStyle( l_dofsLocalA[0] )
print( 'dofsLocalA 1' )
printCStyle( l_dofsLocalA[1] )
print( 'dofsLocalA 2' )
printCStyle( l_dofsLocalA[2] )

print( 'dofsNeigA' )
printCStyle( l_dofsNeighA )
print( 'dofsNeighFsA')
printCStyle( l_dofsNeighFsA )
*/
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wunused-but-set-variable"

float l_rfs[3] = {0.0142, 0.0512, 0.252};

float l_fSolvE[4][9][9] = {
  {
    {0.31502566345387806,0.6686942615102741,0.5240257048836324,0.4324515724140714,0.600432130975785,0.8142123084940156,0.39985121899704656,0.1543684265191141,0.5628388222969362,},
    {0.026977345180984713,0.7876563493948178,0.7019650033591671,0.7065805011608832,0.0545912011591182,0.8062014187557345,0.32789142635669444,0.04383277467728808,0.7817780345840171,},
    {0.04545564425537796,0.5915543218638859,0.38133187855089923,0.16271141716730497,0.21032165415132298,0.27146748213875926,0.17661476441941415,0.7092632178694926,0.8300734026653475,},
    {0.145104758725479,0.2839499700651775,0.18675814738620922,0.5990846238512505,0.9228883330076139,0.9162052839690623,0.5288961059771209,0.8675113822389373,0.9762351708589396,},
    {0.9129466698574331,0.8834094321184481,0.6444924751024506,0.8246843537270405,0.7942610785991858,0.5273766966702069,0.8825073057786866,0.5338618339303438,0.021139176990840447,},
    {0.7787644147790614,0.4570543602158038,0.8613874091831872,0.5254352366074431,0.38171894458920097,0.13633714234056504,0.041031159253460125,0.9405131629213024,0.3193337700706066,},
    {0.08073245532632756,0.10697545851427537,0.852299854007144,0.12845718677742402,0.21055395198417304,0.8521368248412993,0.35175193313938524,0.855427863616338,0.7440056231049751,},
    {0.10995184613860953,0.20956599868882875,0.40645785458234174,0.9716609168068608,0.39611007683105093,0.08272249318852198,0.675749791648789,0.20563187445027964,0.6787477335595944,},
    {0.23383889363393773,0.054742675839971056,0.9313589190382872,0.38216201131090644,0.08053171920572111,0.627140149419777,0.4817278632059505,0.5319296537452306,0.9748488015617851,},
  },
  {
    {0.600785080814032,0.5915212916928712,0.3493547717613231,0.9662846252857071,0.8548456926628406,0.7735629263553444,0.04391413183260806,0.6854049605932606,0.8858152430736789,},
    {0.667924981950854,0.1867779476757424,0.2183784080812342,0.12066512003477525,0.07194010800992046,0.9877663540141196,0.13649699783111024,0.34686400793647265,0.48207291480141023,},
    {0.18040568308983018,0.8591711265668407,0.21149589716104722,0.4882871365587155,0.959039808072128,0.23712759011787699,0.6146223273627577,0.7449229369223274,0.5717077682454518,},
    {0.9183068105773499,0.588013308909576,0.003488374932294258,0.5382228221440003,0.9438779566985037,0.33178094323324814,0.26353188237261727,0.2557777709740163,0.6128992719943979,},
    {0.9208955092050831,0.24962443209447138,0.7829178138909872,0.46046315629073464,0.030568064537779716,0.38293228138751845,0.9830231968674282,0.4037286258068854,0.4069948027631166,},
    {0.2277959888207005,0.8098198043973006,0.1351900414566426,0.431774226477032,0.00011263584762277734,0.8092104485716543,0.6899468018135323,0.29139289553906733,0.21429474020900952,},
    {0.7596166267147831,0.5484736726898856,0.303893702729475,0.0709296364975488,0.15811666250108958,0.5384484083804028,0.9796704261907097,0.07790227369938219,0.7018509328487825,},
    {0.64755685436897,0.4627554466815804,0.14159899383650387,0.6270481933191765,0.8948585225024033,0.5068923141542763,0.969433026272004,0.7900172144380949,0.906382464833375,},
    {0.6644718935395749,0.3386280685462211,0.4555936736348555,0.6955346001862238,0.49184935937873187,0.20291031311036145,0.6694835883812085,0.2465451468103259,0.631586345004049,},
  },
  {
    {0.011501585806741654,0.2254339684489649,0.4488480946430653,0.49887214953450654,0.758857498301866,0.8512384172747164,0.43713128112216526,0.28016403128520895,0.1375727172474821,},
    {0.3009910633719367,0.8383426781896217,0.015928517756633953,0.8047229312927168,0.36847243298558086,0.2071642372269613,0.8149361069563443,0.6676679744075215,0.9419038278203408,},
    {0.7816567304164916,0.9834524241793263,0.14136779901191754,0.7558668914987101,0.12263826700878122,0.49544525749360924,0.07665999408482171,0.49595693030545496,0.274403255653635,},
    {0.006253078678332802,0.6188911571113302,0.46489404080650176,0.6331766037263096,0.08535184011563535,0.8428811439758886,0.6653358742494558,0.0934694593163583,0.09552835506920088,},
    {0.018331698749472825,0.34309146081596764,0.2806300115303154,0.9795058821300665,0.5629753986334924,0.7512406248101109,0.9686878804243347,0.14560756659794327,0.25506879441240593,},
    {0.720779339052024,0.5685482829680449,0.5856170265288826,0.48119938998248835,0.9225578689888816,0.8569518963608754,0.48657002011878303,0.20080274974575352,0.572476437935921,},
    {0.6524285499354338,0.7732328922028542,0.4885637273705874,0.2108611303959117,0.06615849565711673,0.5743819875500165,0.3976665466913717,0.576261438247496,0.07185322745174405,},
    {0.7993315995414616,0.23379657726538283,0.6712607827596982,0.39745311601819144,0.5276788032882803,0.2588731105242157,0.10192504829305782,0.4571675606591682,0.09549208226775685,},
    {0.03973454106198293,0.8005990272394885,0.01927470528805242,0.13255847506360252,0.16935820806987623,0.6108038044003051,0.12032898633921518,0.5052000261675985,0.3362475688030221,},
  },
  {
    {0.5086366947462733,0.9538025451314955,0.09727388896073141,0.07313528972100236,0.860379502155309,0.5803009213865201,0.12118162942077759,0.22037585076031863,0.6803784633987648,},
    {0.9186181359189483,0.27515375420618904,0.1765628078786986,0.42255059300863784,0.9338891610943436,0.14470539491774703,0.5429045627015319,0.5706372442164516,0.5734094636554303,},
    {0.6600787664414439,0.20933842129341806,0.5002995902221733,0.7801339420875241,0.4456128919476785,0.9115627153041054,0.4678510355491027,0.5803315666446759,0.9157128090981275,},
    {0.7073440914043501,0.5242132010356504,0.2879616893912367,0.5571967910574841,0.7906479546119951,0.3430092473837858,0.4372457224854528,0.6955246348143972,0.974120324288659,},
    {0.9009975874561089,0.43343752159194326,0.03614922300599799,0.8908601976322653,0.9555312097043612,0.5917090823067621,0.6404651709150618,0.3280739619426897,0.8741367345796872,},
    {0.6769606765745706,0.08350988205426857,0.40464149214340794,0.1490034959183678,0.15126720667047366,0.4905129613408312,0.00039029606773943737,0.9840890392841251,0.030582857605681912,},
    {0.019313113008287863,0.5425988893678727,0.8609661341186937,0.21144911987650605,0.010661721517663647,0.9827667631143463,0.9445343052040858,0.11475512962501033,0.5427206463855078,},
    {0.15660504620648497,0.1361806330367762,0.894012978552536,0.18369474969582655,0.5736409713280851,0.620717094436384,0.2775798434829321,0.12896129085350738,0.9569240110402756,},
    {0.04155717639518519,0.0482133552395414,0.680345651922374,0.28329690946959774,0.7018870002444677,0.5997917812937408,0.2663867898184734,0.8024712740559365,0.4524335691208976,},
  },
};

float l_fSolvA[4][6][9] = {
  {
    {0.15289367771238904,0.886653790969967,0.9306334720222659,0.9433430118590203,0.7480309399496365,0.9726623031603704,0.7658607639974325,0.7110047663970029,0.6353096503377826,},
    {0.4439741672318973,0.6516957650964602,0.5269153986822442,0.4726915865922885,0.657116064417069,0.567771077567296,0.014748376618127779,0.05618691456223979,0.987950709420194,},
    {0.6133262869432756,0.8613690303165805,0.8490062547338375,0.67012220218093,0.05245501090559779,0.1380048279322913,0.41583918240965734,0.15766481378059172,0.42957445409791617,},
    {0.5579063052099505,0.8345636002121606,0.8640805408422473,0.0033323734380261705,0.5175920519433239,0.7361469286539122,0.14466720482545414,0.02770417099269562,0.7305384285166829,},
    {0.23941902502639711,0.6431203571023046,0.45765719295536555,0.9783010722329234,0.18483404368750544,0.5668800285150782,0.9419013191689349,0.1391467000415878,0.4279849610099733,},
    {0.41760738424279986,0.4070032435568387,0.4476168300514254,0.2501388133074496,0.9978056514233495,0.6888570211887163,0.38501729308456567,0.6108323044449526,0.24759502419392387,},
  },
  {
    {0.3544548390473524,0.49611367886908353,0.990615259543047,0.8260440997109975,0.24042385981795367,0.3065529490258122,0.90999796141851,0.19627655417083933,0.07944788609155662,},
    {0.2199935777891816,0.4050919567718443,0.755480665862891,0.637890703889115,0.7678529927369655,0.6771757114219993,0.9767527063585478,0.17230638470069493,0.34524485196721955,},
    {0.258009993349985,0.047801967444282445,0.9891567794309972,0.9740592760202594,0.2534247040787515,0.21173188170016144,0.23491695268270796,0.5737564485471592,0.9573283745622455,},
    {0.0834622709079923,0.28009782942341654,0.3431659839980632,0.35622272433336044,0.8981549524569347,0.06514284558461825,0.22490609595070588,0.22932242992187968,0.48582206694094054,},
    {0.7052131859912364,0.5912331037580215,0.9874699333101549,0.4456737366772108,0.6132094577766083,0.7434385786738397,0.8019474851494924,0.9534881947127489,0.8096327973022361,},
    {0.5164936187580832,0.9242562607088821,0.20776129724006764,0.9804034412428252,0.6562266299725019,0.9051040151853114,0.2654704431142284,0.606302256966974,0.19813424624224274,},
  },
  {
    {0.8416319916416717,0.24723034223167795,0.13375598559108337,0.2461031439623671,0.3600687816330802,0.14247596680824626,0.623860487690685,0.404360495519122,0.9878088510593029,},
    {0.6942164729592576,0.8041449065121399,0.37658234231019694,0.8625002465750149,0.9097577398443197,0.03281828542791487,0.8380262862901032,0.7598903095095307,0.19724556634932577,},
    {0.2255600296440441,0.6739643473309067,0.3045774805964301,0.982173442435529,0.072894027136432,0.14985527098524865,0.6439021875226807,0.1331223184817315,0.5506800122978934,},
    {0.0787545458188923,0.7003740961086747,0.10221774453447496,0.36153024171623205,0.428789171348793,0.019115257490345594,0.15763600756884733,0.7440820251310885,0.909836825555132,},
    {0.39394375133619575,0.899523095253169,0.6190905055409714,0.8779981493330244,0.6575989061126822,0.9376875628663052,0.4750735264150283,0.8088062440158791,0.9947176374739017,},
    {0.9222901616497177,0.7155926405605043,0.002367269660077387,0.28316396783936504,0.9869204635421029,0.3516838643488728,0.6626337950523442,0.5030718419265641,0.24810945660853256,},
  },
  {
    {0.20486464163829698,0.7353297010971358,0.7816827656396115,0.45246550433665744,0.027005661211387477,0.5676881112297157,0.2604435646938088,0.0046316847604325195,0.5769625020706861,},
    {0.029200989138925326,0.015303546675210167,0.7307360101200022,0.21042110349310994,0.2685320889731563,0.6730964900438644,0.9754420413574172,0.42908123096228956,0.7232095028257435,},
    {0.41014553419080846,0.7221980984086308,0.26716096068188855,0.6263497884655712,0.2974802862388881,0.9921539989171864,0.9119899827381099,0.41491652137590584,0.3281966381672614,},
    {0.13528410050580408,0.6847823188643063,0.7307617670230115,0.3174606417563316,0.779077270455283,0.06431244719874107,0.8235965901557188,0.6697423840963701,0.4517589794298199,},
    {0.3754550664087489,0.0008160918517908788,0.5578751332882056,0.5543526667303511,0.06880053285149501,0.24432143702449338,0.8086860475813998,0.08205599363503979,0.279076336795995,},
    {0.6021212789022629,0.5125328609383577,0.8081583606210657,0.7949654451934328,0.3099713527809633,0.06687833520013231,0.5295585686292826,0.861166792881355,0.044723117486983766,},
  },
};

float l_dofsE[9][10] = {
  {0.5368669939689092,0.013224465478016145,0.8644416930234293,0.31101980741438684,0.08483719166593284,0.4826683272076172,0.38278663363632925,0.8322677001692974,0.7714233275330086,0.8964991217883438,},
  {0.368277101055544,0.6101090288191946,0.33591870942558466,0.9638146297236853,0.785464381447578,0.6751567702334668,0.7011869496238655,0.8467802607982031,0.7034416705020814,0.5947632606865692,},
  {0.12140688892038554,0.3667942689742937,0.9112686422510718,0.5983681883738042,0.6352100183766681,0.6842408412420093,0.4069258631210021,0.6811702757845521,0.01502693265639743,0.17802988669379194,},
  {0.4797616091622243,0.6356313090305482,0.25784564110232877,0.43321954575916655,0.008610538576318438,0.30112453945880846,0.6562265448765717,0.31695495666209095,0.5804014939940874,0.15644295356607418,},
  {0.14868683426073204,0.6357891958073453,0.8707758558886078,0.3939352121662908,0.7089169646749649,0.5672655142625588,0.5425784005549168,0.9479758298066434,0.697240612499603,0.8032863322169681,},
  {0.10218219597790013,0.18576629467195627,0.19785565631887336,0.6309635750304853,0.017515729563623905,0.7084372751352906,0.5536942721886766,0.5201123919488356,0.3213928248954766,0.1166517156262098,},
  {0.07792400762412133,0.09841102418372794,0.884417857258409,0.6696196824886426,0.3605365951273276,0.894578167536445,0.04805053526224545,0.5364532036339619,0.7185295401951468,0.021723619379649062,},
  {0.3095269771719926,0.38447959978308033,0.5719665362775948,0.06956128054303101,0.768928617162076,0.04833335085377044,0.30897783293114744,0.6310753919962865,0.6733076657827068,0.1754975008953501,},
  {0.45597952452664137,0.1669559625204443,0.36979982071014383,0.19379862018052874,0.6239368427228148,0.8468388444017927,0.19234139078195622,0.8144673954714964,0.1687491071566778,0.9909871917334613,},
};

float l_dofsA[3][6][10] = {
  {
    {0.027920203044636716,0.7501482925418662,0.04528035645023032,0.31878423041415915,0.20544512385571279,0.5115757825171984,0.8046112663931546,0.5823860652093198,0.6459319055743562,0.6310341561711799,},
    {0.5512234597760803,0.5417326437370152,0.4431765914465434,0.5487340310690585,0.8232236993388766,0.8658338388993251,0.7192434430299569,0.6580437297576857,0.45462300668317546,0.09238360961568248,},
    {0.6782608942842698,0.36516121945424473,0.7981372353751272,0.12493342564996102,0.4934233955686983,0.8410572138397833,0.4520307591846754,0.1805870706889634,0.051110999241976485,0.08895785597214556,},
    {0.23068007406892355,0.575176545903077,0.36405050404469597,0.18040036059318043,0.2994273481349812,0.12964529118160428,0.9261798901319492,0.9511247289726361,0.8883689326374066,0.96062577670812,},
    {0.6586048315572283,0.0547514303623553,0.3081946756808286,0.14814593533808318,0.8969140460573386,0.2699593583218681,0.427139470161471,0.7184294106224952,0.4418830629881727,0.41366782896032817,},
    {0.33434726589046315,0.07403717262813148,0.746722639033392,0.956924525313502,0.7714249538612207,0.4889183962010262,0.6306082188850504,0.3015528343873617,0.7946896327167435,0.4544370441448352,},
  },
  {
    {0.9549537677835575,0.7327703993701707,0.6088384111059496,0.07695487507792176,0.017696404215638895,0.805993373541131,0.7734791520498273,0.5649355578856415,0.521072029349515,0.5775341310090589,},
    {0.9740421732149224,0.4990910802293026,0.2805719142650389,0.16100004140716306,0.6869764287400071,0.804364102023363,0.7347911476778706,0.30165760619053694,0.9849414134517672,0.5586063483968826,},
    {0.9889688613600414,0.6867065108820506,0.9660589214618642,0.6471783225930412,0.41945749895004547,0.5528069907604088,0.2201849778695112,0.5034996032180346,0.7269139500852195,0.1396354514613798,},
    {0.11681136103894463,0.7867498108864719,0.7258279527230973,0.3397872859105858,0.04684783948730775,0.12977712040224787,0.4939558079958598,0.5466698759756436,0.823719620041957,0.022970401727640755,},
    {0.7190302802676313,0.8786431833962371,0.836909817367537,0.056373191297334424,0.5393248243575922,0.13393379071717593,0.7424726201732371,0.12666594089923344,0.7821079266991319,0.9500011622438143,},
    {0.5124132102454964,0.7870833887404922,0.009436542796784075,0.8501103780788895,0.8293011747882232,0.14440293035828256,0.8243082036508947,0.570624803065271,0.17354607345980133,0.5196458387814902,},
  },
  {
    {0.5234332591177392,0.5631185136520922,0.5167932360137195,0.003262548563832901,0.9322746665428855,0.5343400406480482,0.9729942210821515,0.8442939387694768,0.9923756075146049,0.6758603256637084,},
    {0.02615368916705474,0.435488002405374,0.466707775729299,0.657238650762792,0.10979331856993835,0.948608448488753,0.9371419867610591,0.7474817697985153,0.6516260495228741,0.008446162141363844,},
    {0.9605401542355072,0.31715638186456685,0.7316888569459239,0.5107181595953325,0.7679418801289193,0.13591222554402227,0.5122865315168502,0.18708206679950878,0.49462894596862006,0.018937753370059318,},
    {0.23402918627165137,0.2145433992933311,0.6377911444811094,0.6531411380714763,0.3743208197583977,0.665889269751023,0.8510160845350568,0.09593706098555244,0.3447539420984722,0.07176249500140253,},
    {0.4346766824125461,0.45070312025093806,0.10414630310115458,0.2732012492241048,0.08978552345281643,0.10631410637628924,0.9072295462734342,0.7440025152437769,0.844985584463114,0.6150216907880769,},
    {0.5360235229024387,0.9460445029045115,0.761942630052978,0.9290930089365955,0.031636636269654295,0.17327965217951768,0.33041548250958175,0.725541021844499,0.981663607092802,0.2456659181952615,},
  },
};

float l_tDofsE[9][10] = {
  {0.4780618020757581,0.474719345429111,0.15295893250412818,0.32173812550513003,0.8447354194944613,0.05021250849051728,0.3572441571635475,0.8109178140165463,0.706101626579549,0.5446212644595511,},
  {0.17233219243234166,0.6472579601456072,0.30355120970912586,0.41070060099176675,0.5559348959228195,0.5159591957004569,0.1096849540132333,0.6314490803181747,0.05208379452808731,0.05485738887289926,},
  {0.9411403862097424,0.5332405898032233,0.6931362926433794,0.060035523504603616,0.09105270485651695,0.6976147062133821,0.5330013257867603,0.8645862545017974,0.03540712407065327,0.6987495425657437,},
  {0.9500755955882899,0.27768238924012956,0.1674944813382926,0.6206782487304486,0.861267500307749,0.7115668641774274,0.8379016726998958,0.24088721049627182,0.4318101264702596,0.41524593336678695,},
  {0.9688132161645737,0.24754652676301026,0.9718934760112893,0.7164147301097085,0.4448939530485726,0.12894574018399496,0.32621149882005807,0.5482287300154562,0.685694344312362,0.4638484842010765,},
  {0.9435516371062797,0.7325926015892662,0.4348011553875396,0.24066985756768922,0.21082966281640292,0.5142598640448854,0.8700407075597396,0.37200592094184204,0.6186648885155009,0.4361547760251353,},
  {0.5218533517315908,0.006167867793398396,0.9484632251200636,0.7666229742182246,0.589697396935022,0.7109263843494841,0.4680067700571925,0.11579432151278268,0.6141011867302728,0.0920812054008866,},
  {0.48819108279960266,0.012937441142086059,0.954218821610174,0.5694453288118575,0.8330046097513446,0.2069028989815157,0.6302804994734054,0.6340596143477064,0.7862371934027583,0.7849911932583787,},
  {0.19031963139832397,0.9524884497508523,0.23439669066834345,0.6875201765053258,0.2478464799452773,0.645342234877958,0.2899723343809192,0.0693027983874821,0.0858703330475934,0.49108924135237175,},
};

float l_refEdofs[9][10] = {
  {51.02236435949935,45.96367705476446,31.495227451598986,27.25850849102928,98.17227891826244,38.2399623714625,111.57112827477897,59.02578455151658,28.83364001814191,119.48651792233647,},
  {47.08031078774988,49.208829049611914,42.37983028635504,41.68620789720248,92.21378899902729,58.05445260035326,108.4849056480281,45.75504183087779,56.08679301517754,108.82585025546533,},
  {48.86227730549624,56.728163787619316,49.75831532131893,55.31709063427053,100.27137262750296,59.41496489126398,102.68467392369392,73.22653578565227,63.56726863118763,135.41039956987692,},
  {56.088264894178224,43.204021891699725,48.630907730822024,49.97151734355818,107.13510948245326,46.765379629672836,113.14677297031247,60.295622060761175,65.70819120520173,136.36545894184138,},
  {64.33854906112012,38.44350043286492,57.502585962731004,46.05653558313314,124.67498933103799,60.65080370869371,128.82921527388305,69.9046953001438,68.75824305115258,151.9339312821266,},
  {47.81031173966616,33.09564728388116,46.214050717837516,9.76094344578873,96.04413667652108,47.36485353680577,105.12824202084698,25.028659487733673,22.049872098570688,108.43978441668278,},
  {43.79414725422827,40.433688527087035,45.69468364473252,33.68153446091944,85.75946021653017,51.31417525965068,97.37578999553364,58.111343383804694,46.2041096797019,109.23275391871142,},
  {48.61422037794857,40.27638341426774,33.19410462897258,36.873416448799546,98.79968962477113,45.334369121037994,101.0203874719943,59.627749275983504,34.649713681355934,121.03965048945052,},
  {42.4531986081313,34.69799537924174,33.08652466169676,45.31069469938512,80.57602285378515,39.98888801704611,96.09638725580837,55.16181337350033,60.153815122307016,106.74015313307325,},
};

float l_refEneighDofs[9][10] = {
  {13.921088362932297,10.02115780474705,-7.276571443935684,65.36520644992142,10.968468714824793,-1.2554269745242626,15.038614446057764,45.927782506325684,-26.647142029939427,146.7972848047434,},
  {13.24752587641782,9.031306484001867,-8.569570925974908,65.84435068675288,8.891656575554796,-3.3837448035806696,13.247698565782757,45.33575192131521,-25.293885261687286,145.81879915097878,},
  {8.849519392692986,7.272380976764098,-7.014810617025398,45.25942325872347,8.126046158712132,-0.7462726466491976,9.795850810917996,31.349167617137837,-26.850171976057982,103.11955890663005,},
  {16.43144012370746,14.122916692925024,-10.068946673021252,77.03111904871446,16.143429102193167,-1.0291018006289097,18.438256027767572,54.810420127682974,-35.90039569155054,172.88065246530294,},
  {17.440457485753477,15.446789957564015,-8.422343940210792,81.33490750397274,18.677347772230274,2.4798814549105552,26.334619594711548,56.70055270853801,-43.73118751974662,185.8908387642703,},
  {12.893299063699299,10.652537870125066,-5.51372269811995,59.831354692623194,13.136328419111505,2.464743581758285,21.331016759612183,39.64171001376224,-30.866781711734617,135.6064232949481,},
  {13.321743133314236,11.607391375513767,-5.304034821196863,61.568187638064444,12.381120701293831,-0.43737837738106333,14.929402881897175,49.514539430237406,-21.639312753257084,133.24496753800614,},
  {11.318674478937934,9.346327330721225,-7.042098258011926,53.767515852724124,10.540366636589145,-0.9920694398619068,13.337941071874825,39.08974432404118,-27.17610243329381,121.93430522499507,},
  {13.769207857566895,10.646562125559164,-7.00319240230456,63.65332634535779,11.313887755299742,-1.6830711033653698,14.651508318085755,48.89332143413455,-24.369468813951777,141.21633984462886,},
};

float l_refEneighFdofs[9][10] = {
  {13.921088362932297,21.075646612210384,26.40755277529317,-20.00455380840046,25.422370569685853,35.46259486504061,37.02415624583606,-30.84783528999053,-32.07437048310742,26.79087195842288,},
  {13.24752587641782,22.398385107901536,23.861852931740767,-18.118218945690167,24.67316328118368,37.57429875190214,33.55043302570539,-33.57546733560838,-28.09728706552119,24.045182825842293,},
  {8.849519392692986,15.593976809586406,18.883239974241835,-9.843040457886328,19.733206382966436,26.019224435267695,25.912588418279135,-19.60057612269864,-21.540695215514187,10.595493879082841,},
  {16.43144012370746,25.11476678675868,32.728341455808106,-22.3755417345331,31.22497107735645,40.27820387514374,49.17179638297352,-34.90450777242625,-39.78920553250156,28.17986268905336,},
  {17.440457485753477,25.77681963785707,35.657792219548476,-26.13687123958783,37.28166556932965,42.37070022098375,52.15748028526143,-28.532998464723363,-45.104518399054996,37.6142569509484,},
  {12.893299063699299,18.33416559353143,24.972212668928275,-20.40186445210763,27.21898072585245,30.65720477812326,37.69000965451348,-20.139616781020834,-32.58761230689844,31.337005677360622,},
  {13.321743133314236,18.62442445175074,27.410895098036974,-20.496985277616343,22.38936657735386,34.05619625414494,38.854020811258735,-27.40640390994271,-34.381070108105845,28.396316272332086,},
  {11.318674478937934,17.834536811627235,22.739766738606892,-15.358318814113233,22.92051984362648,29.701991777863924,32.237095747637255,-22.975767010868267,-27.3143157848696,18.975729103921005,},
  {13.769207857566895,20.28459389090486,26.148028029460427,-20.476476907886045,23.841257580631876,36.17311669788261,37.38398820562,-29.84414053586408,-32.8016054977782,28.01197591179864,},
};

float l_refVdofsA[3][6][10] = {
  {
    {0.7170403606396097,1.1306419946808055,0.45001920012317354,0.7691111543193355,1.67530493042378,1.2031062657093883,2.2894651510168296,1.2889581581121878,1.2075198263361249,1.9748624104168409,},
    {1.2569207604561783,1.2012640500818272,1.1009617833551792,0.9890382976324528,2.18468085160346,1.720074512853582,2.4753405285814494,1.3639256655668888,0.9144851533786156,1.7864257312811094,},
    {1.3955404036003214,1.0091021593442708,1.3349677327666605,0.7653221418074975,1.868936716597205,1.6743464033267679,2.013056817011762,1.0787908792958492,0.8654859457355495,1.7943480909151854,},
    {0.8045014295238613,1.1477347623751475,0.998885719256192,0.8066424358695492,1.367989966372996,0.8431967076706888,2.2073393294689563,1.761847731053623,1.775735184633623,2.4008095201696253,},
    {1.4424461091417131,0.7430065003852537,0.8742004313836009,0.378511585915999,2.5749579129421543,1.1295135999519694,2.2282398036766824,0.9872825610627186,0.5763817451816274,2.0991682997938206,},
    {1.1218176233839217,0.6749082905777789,1.3816484697095655,1.5279063251428875,2.3971056976539837,1.0247393466139356,2.3746214621189266,1.1620712552091423,1.5913573757681136,2.21580708141461,},
  },
  {
    {3.4396687022105024,2.104691353561276,2.068178467166139,1.7006688542289798,5.317472608179374,3.299399059417196,6.127318510692937,3.112575780183307,2.5459524197018073,5.422886709697639,},
    {3.5185282151037267,2.8771198129655264,2.6523044372032185,1.7485759884526413,5.5958923580320254,3.8844431517739224,7.066634160370576,2.8468093747420293,2.6430359142127915,6.666701885669408,},
    {3.5752161062179164,3.0085217307672147,2.9016731092397867,2.9561855245131725,5.379054825475366,3.5573426598965785,5.848673299048866,3.742093617349905,3.663251785329652,6.288648129565862,},
    {2.18580103704548,2.851185070278726,3.01481126390821,2.5977868812732674,3.899693336232825,2.7025822277431724,5.113347589267323,3.4698401370000473,4.023237373718455,5.2157455894198295,},
    {3.5452748867694366,3.3602389288309134,2.8777193027183783,0.8869873680289746,6.589736513407068,3.233171619693316,7.236580864960478,1.0960519481203204,1.2670609216501796,7.027298634544858,},
    {3.3517429499402196,2.9536046027561227,2.2987465801643956,2.908861656336955,6.690910617195932,2.076377061424547,7.112581306015294,3.6733391091269025,3.046038217419671,6.870501184430255,},
  },
  {
    {12.75288957700036,7.31554196006144,7.699482574434965,7.994979789697946,27.017110670426895,12.806571150819305,27.323922314403703,13.383460657890797,10.958583778779794,24.52408004889657,},
    {12.549795926588514,12.139848171341475,12.140078787065649,8.471089015127255,24.27086390805409,16.108372521479787,32.10168181485797,13.274400630637892,8.812559920456037,30.071728884654572,},
    {13.689725812520363,11.744840667236861,10.258539937415385,11.87536298154598,25.178459971620732,14.923861222073606,28.215002487321485,16.127036980104805,14.946916728812312,30.28360952841556,},
    {10.41733774786632,10.375435691614584,11.903880879220335,11.766732896497174,19.337544749052743,13.328914407444636,23.587085007980537,14.483415689465037,16.092380385974987,25.62995287192389,},
    {14.345099355038618,12.664807179812234,10.148755488812327,4.361380400325145,29.869155555493208,15.360375295868227,32.87041856358564,5.515199269535066,3.231863606487801,30.526720187269767,},
    {14.510849585462402,11.60939110313769,12.02964047022169,11.06200945661301,28.881745610620094,9.682214828521289,31.28050965820936,15.99671299699159,15.119710878145284,31.50378207256028,},
  },
};

float l_refVneighDofsA[6][10] = {
  {20.63331304319193,17.422268128088685,-11.265179570362498,97.00947665823345,18.706523578843015,-0.7601844676215672,24.864028473949563,72.88991113991393,-43.33905691445702,216.5051607940591,},
  {12.562036489554455,7.73556387816379,-8.967275731186819,64.0418943007953,8.667127405941965,-2.829410385621347,12.819868999510335,39.038225909778355,-27.3684687116648,145.54116763581783,},
  {11.576759985756643,7.996270109818226,-7.964754741607619,57.85228456057261,8.663230847163248,-1.0784221243527454,15.879620003907238,37.009051210187394,-31.576730561378632,133.17789042506652,},
  {12.791407958059422,8.540875397275196,-8.057100647496634,63.47326504051854,8.52501820467909,-2.2301890281627648,13.275652402667088,42.36980771051523,-25.262390601857412,142.40181272499066,},
  {13.425709925442623,10.58173680598285,-9.292889278837539,65.83970210006781,11.610342566988665,-1.9103113307161812,16.219650227013744,46.57305170428196,-33.951622815153534,149.4188286037821,},
  {13.515948305393987,12.206410426703881,-6.04287535854016,61.41620645880621,14.302047039010722,1.560447090691913,17.671359084135645,45.74552906659882,-27.16811707990426,137.11201107498297,},
};

float l_refVneighFdofsA[6][10] = {
  {20.63331304319193,30.284129366835757,41.27546687555091,-31.606968973572982,38.2941123589622,52.495118827863095,59.64508892327403,-42.31428299897625,-54.70941933539983,41.40836016021161,},
  {12.562036489554455,21.757868717939445,22.482280176215408,-18.570033553617424,25.42149940958921,34.337315750617655,31.751965509099293,-33.958184894761516,-27.583292944261824,22.81625234543288,},
  {11.576759985756643,19.273589730787336,21.631200030121008,-16.979010167874875,25.20166641716258,32.27448512326954,30.442229637451995,-24.55938945863644,-27.248462887864836,22.348406276207616,},
  {12.791407958059422,20.996496763579994,23.309561477702793,-19.65098154901432,24.144146199252706,34.79530076499789,32.198854852939206,-32.66732286451693,-30.46635610739607,24.807730623729075,},
  {13.425709925442623,21.5169515243075,26.631080971128025,-18.980517131777592,27.11951352965665,36.64901828763346,38.61352614918074,-29.126950362627085,-32.80806116074016,23.642869466358643,},
  {13.515948305393987,18.417557130214167,27.518394205162902,-21.64379019159286,25.344742050354455,30.926696997028433,40.773644725922246,-24.797783296855517,-37.71623978588547,29.664169419469683,},
};

#pragma GCC diagnostic pop